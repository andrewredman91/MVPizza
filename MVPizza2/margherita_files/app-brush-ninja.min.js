"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var a,o,i=[],r=!0,s=!1;try{for(n=n.call(t);!(r=(a=n.next()).done)&&(i.push(a.value),!e||i.length!==e);r=!0);}catch(t){s=!0,o=t}finally{try{r||null==n.return||n.return()}finally{if(s)throw o}}return i}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _createForOfIteratorHelper(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,o=function(){};return{s:o,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,i=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw i}}}}function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach((function(e){_defineProperty(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}var runtime=function(t){var e,n=Object.prototype,a=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",r=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function c(t,e,n,a){var o=e&&e.prototype instanceof g?e:g,i=Object.create(o.prototype),r=new A(a||[]);return i._invoke=function(t,e,n){var a=d;return function(o,i){if(a===f)throw new Error("Generator is already running");if(a===m){if("throw"===o)throw i;return B()}for(n.method=o,n.arg=i;;){var r=n.delegate;if(r){var s=S(r,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===d)throw a=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=f;var l=u(t,e,n);if("normal"===l.type){if(a=n.done?m:p,l.arg===h)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(a=m,n.method="throw",n.arg=l.arg)}}}(t,n,r),i}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var d="suspendedStart",p="suspendedYield",f="executing",m="completed",h={};function g(){}function v(){}function b(){}var y={};l(y,i,(function(){return this}));var k=Object.getPrototypeOf,w=k&&k(k(L([])));w&&w!==n&&a.call(w,i)&&(y=w);var x=b.prototype=g.prototype=Object.create(y);function T(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(o,i,r,s){var l=u(t[o],t,i);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"===_typeof(d)&&a.call(d,"__await")?e.resolve(d.__await).then((function(t){n("next",t,r,s)}),(function(t){n("throw",t,r,s)})):e.resolve(d).then((function(t){c.value=t,r(c)}),(function(t){return n("throw",t,r,s)}))}s(l.arg)}var o;this._invoke=function(t,a){function i(){return new e((function(e,o){n(t,a,e,o)}))}return o=o?o.then(i,i):i()}}function S(t,n){var a=t.iterator[n.method];if(a===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method))return h;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var o=u(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,h;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function D(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(D,this),this.reset(!0)}function L(t){if(t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,r=function n(){for(;++o<t.length;)if(a.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return r.next=r}}return{next:B}}function B(){return{value:e,done:!0}}return v.prototype=b,l(x,"constructor",b),l(b,"constructor",v),v.displayName=l(b,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,l(t,s,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},T(E.prototype),l(E.prototype,r,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,a,o,i){void 0===i&&(i=Promise);var r=new E(c(e,n,a,o),i);return t.isGeneratorFunction(n)?r:r.next().then((function(t){return t.done?t.value:r.next()}))},T(x),l(x,s,"Generator"),l(x,i,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var a=e.pop();if(a in t)return n.value=a,n.done=!1,n}return n.done=!0,n}},t.values=L,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(a,o){return s.type="throw",s.arg=t,n.next=a,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],s=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=a.call(r,"catchLoc"),c=a.call(r,"finallyLoc");if(l&&c){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&a.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var r=i?i.completion:{};return r.type=t,r.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(r)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),C(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var a=n.completion;if("throw"===a.type){var o=a.arg;C(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,a){return this.delegate={iterator:L(t),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=e),h}},t}("object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports:{});try{regeneratorRuntime=runtime}catch(t){"object"===("undefined"==typeof globalThis?"undefined":_typeof(globalThis))?globalThis.regeneratorRuntime=runtime:Function("r","regeneratorRuntime = r")(runtime)}!function(){if("function"==typeof window.CustomEvent)return!1;function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}t.prototype=window.Event.prototype,window.CustomEvent=t}(),String.prototype.padStart||(String.prototype.padStart=function(t,e){return t>>=0,e=String(void 0!==e?e:" "),this.length>t?String(this):((t-=this.length)>e.length&&(e+=e.repeat(t/e.length)),e.slice(0,t)+String(this))});var ready=function(t){if("function"==typeof t)return"interactive"===document.readyState||"complete"===document.readyState?t():void document.addEventListener("DOMContentLoaded",t,!1)},Reef=function(){var t,e=["checked","selected","value"],n=!1,a=function(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()},o=function(t){if(n)throw new Error(t)},i=function t(e,n){var o=a(e);if("object"===o){var i={};for(var r in e)e.hasOwnProperty(r)&&(i[r]=t(e[r],n));return i}if("array"===o)return e.map((function(e){return t(e,n)}));if("string"===o&&!n){var s=document.createElement("div");return s.textContent=e,s.innerHTML}return e},r=function(t,e){var n=t.filter(e);return n.length<1?null:n[0]},s=function(t,e){if(!(t||e&&e.lagoon))return o("Reef.js: You did not provide an element to make into a component.");if(!e||!e.template&&!e.lagoon)return o("Reef.js: You did not provide a template for this component.");if(this.elem=t,this.data=e.data,this.template=e.template,this.allowHTML=e.allowHTML,this.attached=[],this.lagoon=e.lagoon,e.attachTo){var n=this;e.attachTo.forEach((function(t){"attach"in t&&t.attach(n)}))}},l=function(t,e){e.forEach((function(e){t.style[e]=""}))},c=function(t,e,n){(function(t,e){return t.reduce((function(t,n){if(n.att.length>7&&"default"===n.att.slice(0,7)){if(!e)return t;n.att=n.att.slice(7)}return t.push(n),t}),[])})(e,n).forEach((function(e){if("class"===e.att)t.className=e.value;else if("style"===e.att)!function(t,e){var n=function(t){return t.split(";").reduce((function(t,e){if(e.indexOf(":")>0){var n=e.trim().split(":");t.push({name:n[0]?n[0].trim():"",value:n[1]?n[1].trim():""})}return t}),[])}(e),a=Array.prototype.filter.call(t.style,(function(e){return null===r(n,(function(n){return n.name===e&&n.value===t.style[e]}))}));l(t,a),function(t,e){e.forEach((function(e){t.style[e.name]=e.value}))}(t,n)}(t,e.value);else{if(e.att in t)try{t[e.att]=e.value,t[e.att]||(t[e.att]=!0)}catch(t){}try{t.setAttribute(e.att,e.value||"")}catch(t){}}}))},u=function(t,e){e.forEach((function(e){if("class"===e.att)t.className="";else if("style"===e.att)l(t,Array.prototype.slice.call(t.style));else{if(e.att in t)try{t[e.att]=""}catch(t){}try{t.removeAttribute(e.att)}catch(t){}}}))},d=function(t,e){return{att:t,value:e}},p=function(t,n){if(1!==t.nodeType)return[];var a=function(t,n){return Array.prototype.reduce.call(t.attributes,(function(t,a){return(e.indexOf(a.name)<0||n&&"selected"===a.name)&&t.push(d(a.name,a.value)),t}),[])}(t,n);return function(t,n,a){e.forEach((function(e){!t[e]||a&&"option"===t.tagName.toLowerCase()&&"selected"===e||a&&"select"===t.tagName.toLowerCase()&&"value"===e||n.push(d(e,t[e]))}))}(t,a,n),a},f=function(t){return 3===t.nodeType?"text":8===t.nodeType?"comment":t.tagName.toLowerCase()},m=function(t){return t.childNodes&&t.childNodes.length>0?null:t.textContent},h=function t(e){1===e.nodeType&&(Array.prototype.forEach.call(e.attributes,(function(t){t.name.length<8||"default"!==t.name.slice(0,7)||(c(e,[d(t.name.slice(7).toLowerCase(),t.value)]),u(e,[d(t.name,t.value)]))})),e.childNodes&&Array.prototype.forEach.call(e.childNodes,(function(e){t(e)})))},g=function t(n,a,o){var i=Array.prototype.slice.call(a.childNodes),s=Array.prototype.slice.call(n.childNodes),l=i.length-s.length;if(l>0)for(;l>0;l--)i[i.length-l].parentNode.removeChild(i[i.length-l]);s.forEach((function(n,s){if(!i[s])return h(n),void a.appendChild(n.cloneNode(!0));if(f(n)===f(i[s])){!function(t,n){var a=p(t,!0),o=p(n),i=o.filter((function(t){return!(e.indexOf(t.att)>-1)&&null===r(a,(function(e){return t.att===e.att}))})),s=a.filter((function(t){var e=r(o,(function(e){return t.att===e.att}));return null===e||e.value!==t.value}));c(n,s),u(n,i)}(n,i[s]);var l=o.filter((function(t){return 3!==n.nodeType&&function(t,e){return Element.prototype.matches&&t.matches(e)||Element.prototype.msMatchesSelector&&t.msMatchesSelector(e)||Element.prototype.webkitMatchesSelector&&t.webkitMatchesSelector(e)}(n,t)}));if(!(l.length>0)){var d=m(n);if(d&&d!==m(i[s])&&(i[s].textContent=d),i[s].childNodes.length>0&&n.childNodes.length<1)i[s].innerHTML="";else{if(i[s].childNodes.length<1&&n.childNodes.length>0){var g=document.createDocumentFragment();return t(n,g,o),void i[s].appendChild(g)}n.childNodes.length>0&&t(n,i[s],o)}}}else i[s].parentNode.replaceChild(n.cloneNode(!0),i[s])}))},v=function(t,e){t&&t.forEach((function(t){if(t.attached.indexOf(e)>-1)return o("ReefJS: "+e.elem+" has attached nodes that it is also attached to, creating an infinite loop.");"render"in t&&t.render()}))};return s.emit=function(t,e,n){var a;if(!t||!e)return o("ReefJS: You did not provide an element or event name.");a=new CustomEvent(e,{bubbles:!0,detail:n}),t.dispatchEvent(a)},s.prototype.render=function(){if(this.lagoon)v(this.attached,this);else{if(!this.template)return o("Reef.js: No template was provided.");var e="string"===a(this.elem)?document.querySelector(this.elem):this.elem;if(!e)return o("Reef.js: The DOM element to render your template into was not found.");var n=i(this.data||{},this.allowHTML),r="function"===a(this.template)?this.template(n):this.template;if(!(["string","number"].indexOf(a(r))<0)&&e.innerHTML.trim()!==r.trim()){var l=this.attached.map((function(t){return t.elem}));return g(function(e){if(t){var n=(new DOMParser).parseFromString(e,"text/html");return n.head.childNodes.length>0&&Array.prototype.slice.call(n.head.childNodes).reverse().forEach((function(t){n.body.insertBefore(t,n.body.firstChild)})),n.body}var a=document.createElement("div");return a.innerHTML=e,a}(r),e,l),s.emit(e,"reef-render",n),v(this.attached,this),e}}},s.prototype.getData=function(){return i(this.data,!0)},s.prototype.setData=function(t){if("object"!==a(t))return o("ReefJS: The provided data is not an object.");for(var e in t)t.hasOwnProperty(e)&&(this.data[e]=t[e]);s.emit(document,"reef-set-data",t),this.render()},s.prototype.attach=function(t){"array"===a(t)?Array.prototype.push.apply(this.attached,t):this.attached.push(t)},s.prototype.detach=function(t){var e="array"===a(t);this.attached=this.attached.filter((function(n){return e?-1===t.indexOf(n):n!==t}))},s.debug=function(t){n=!!t},t=function(){if(!window.DOMParser)return!1;var t=new DOMParser;try{t.parseFromString("x","text/html")}catch(t){return!1}return!0}(),s}();
/*! Reef v5.X.0.brushninja | (c) 2020 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/reef */!function(t,e,n){var a=null,o=null;function i(e){if(t.event&&t.event.contentOverflow!==n)return{x:t.event.offsetX,y:t.event.offsetY};if(e.offsetX!==n&&e.offsetY!==n)return{x:e.offsetX,y:e.offsetY};var a=e.target.parentNode.parentNode;return{x:e.layerX-a.offsetLeft,y:e.layerY-a.offsetTop}}function r(t,n,a){for(var o in t=e.createElementNS("http://www.w3.org/2000/svg",t),n)t.setAttribute(o,n[o]);"[object Array]"!==Object.prototype.toString.call(a)&&(a=[a]);for(var i=0,r=a[0]&&a.length||0;i<r;i++)t.appendChild(a[i]);return t}function s(t){var e,n,a,o,i,r=t.h%360/60;o=(i=t.v*t.s)*(1-Math.abs(r%2-1)),e=n=a=t.v-i,e+=[i,o,0,0,o,i][r=Math.floor(r)],n+=[o,i,i,o,0,0][r],a+=[0,0,o,i,i,o][r];var s=Math.floor(255*e),l=Math.floor(255*n),c=Math.floor(255*a);return{r:s,g:l,b:c,hex:"#"+(16777216|c|l<<8|s<<16).toString(16).slice(1)}}function l(t){var e,n,a=t.r,o=t.g,i=t.b;return(t.r>1||t.g>1||t.b>1)&&(a/=255,o/=255,i/=255),{h:(0==(n=(e=Math.max(a,o,i))-Math.min(a,o,i))?null:e==a?(o-i)/n+(o<i?6:0):e==o?(i-a)/n+2:(a-o)/n+4)%6*60,s:0==n?0:n/e,v:e}}function c(e,a,o){return function(r){var l=i(r=r||t.event);e.h=l.y/a.offsetHeight*360+15;var c=s({h:e.h,s:1,v:1}),u=s({h:e.h,s:e.s,v:e.v});o.style.backgroundColor=c.hex,e.callback&&e.callback(u.hex,{h:e.h-15,s:e.s,v:e.v},{r:u.r,g:u.g,b:u.b},n,l)}}function u(e,n){return function(a){var o=i(a=a||t.event),r=n.offsetWidth,l=n.offsetHeight;e.s=o.x/r,e.v=(l-o.y)/l;var c=s(e);e.callback&&e.callback(c.hex,{h:e.h-15,s:e.s,v:e.v},{r:c.r,g:c.g,b:c.b},o)}}o=r("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"100%",height:"100%"},[r("defs",{},r("linearGradient",{id:"gradient-hsv",x1:"0%",y1:"100%",x2:"0%",y2:"0%"},[r("stop",{offset:"0%","stop-color":"#FF0000","stop-opacity":"1"}),r("stop",{offset:"13%","stop-color":"#FF00FF","stop-opacity":"1"}),r("stop",{offset:"25%","stop-color":"#8000FF","stop-opacity":"1"}),r("stop",{offset:"38%","stop-color":"#0040FF","stop-opacity":"1"}),r("stop",{offset:"50%","stop-color":"#00FFFF","stop-opacity":"1"}),r("stop",{offset:"63%","stop-color":"#00FF40","stop-opacity":"1"}),r("stop",{offset:"75%","stop-color":"#0BED00","stop-opacity":"1"}),r("stop",{offset:"88%","stop-color":"#FFFF00","stop-opacity":"1"}),r("stop",{offset:"100%","stop-color":"#FF0000","stop-opacity":"1"})])),r("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#gradient-hsv)"})]),a=r("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"100%",height:"100%"},[r("defs",{},[r("linearGradient",{id:"gradient-black",x1:"0%",y1:"100%",x2:"0%",y2:"0%"},[r("stop",{offset:"0%","stop-color":"#000000","stop-opacity":"1"}),r("stop",{offset:"100%","stop-color":"#CC9A81","stop-opacity":"0"})]),r("linearGradient",{id:"gradient-white",x1:"0%",y1:"100%",x2:"100%",y2:"100%"},[r("stop",{offset:"0%","stop-color":"#FFFFFF","stop-opacity":"1"}),r("stop",{offset:"100%","stop-color":"#CC9A81","stop-opacity":"0"})])]),r("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#gradient-white)"}),r("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#gradient-black)"})]);var d=0;function p(t,e,n){if(!(this instanceof p))return new p(t,e,n);if(this.h=0,this.s=1,this.v=1,n)this.callback=n,this.pickerElement=e,this.slideElement=t;else{var i=t;i.innerHTML='\n\t\t<div class="picker-wrapper">\n\t\t\t<div class="picker"></div>\n\t\t\t<div class="picker-indicator"></div>\n\t\t</div>\n\t\t<div class="slide-wrapper">\n\t\t\t<div class="slide"></div>\n\t\t\t<div class="slide-indicator"></div>\n\t\t</div>',this.slideElement=i.getElementsByClassName("slide")[0],this.pickerElement=i.getElementsByClassName("picker")[0];var r=i.getElementsByClassName("slide-indicator")[0],s=i.getElementsByClassName("picker-indicator")[0];p.fixIndicators(r,s),this.callback=function(t,n,a,o,i){p.positionIndicators(r,s,i,o),e(t,n,a)}}var l=o.cloneNode(!0),h=a.cloneNode(!0),g=l.getElementsByTagName("linearGradient")[0],v=l.getElementsByTagName("rect")[0];g.id="gradient-hsv-"+d,v.setAttribute("fill","url(#"+g.id+")");var b=[h.getElementsByTagName("linearGradient")[0],h.getElementsByTagName("linearGradient")[1]],y=h.getElementsByTagName("rect");b[0].id="gradient-black-"+d,b[1].id="gradient-white-"+d,y[0].setAttribute("fill","url(#"+b[1].id+")"),y[1].setAttribute("fill","url(#"+b[0].id+")"),this.slideElement.appendChild(l),this.pickerElement.appendChild(h),d++,f(this.slideElement,"click",c(this,this.slideElement,this.pickerElement)),f(this.pickerElement,"click",u(this,this.pickerElement)),m(this,this.slideElement,c(this,this.slideElement,this.pickerElement)),m(this,this.pickerElement,u(this,this.pickerElement))}function f(t,e,n){t.attachEvent?t.attachEvent("on"+e,n):t.addEventListener&&t.addEventListener(e,n,!1)}function m(t,e,n){var a=!1;f(e,"mousedown",(function(t){a=!0})),f(e,"mouseup",(function(t){a=!1})),f(e,"mouseout",(function(t){a=!1})),f(e,"mousemove",(function(t){a&&n(t)}))}function h(t,e,n,a){t.h=e.h%360,t.s=e.s,t.v=e.v;var o=s(t),i={y:t.h*t.slideElement.offsetHeight/360,x:0},r=t.pickerElement.offsetHeight,l={x:t.s*t.pickerElement.offsetWidth,y:r-t.v*r};return t.pickerElement.style.backgroundColor=s({h:t.h,s:1,v:1}).hex,t.callback&&t.callback(a||o.hex,{h:t.h,s:t.s,v:t.v},n||{r:o.r,g:o.g,b:o.b},l,i),t}p.hsv2rgb=function(t){var e=s(t);return delete e.hex,e},p.hsv2hex=function(t){return s(t).hex},p.rgb2hsv=l,p.rgb2hex=function(t){return s(l(t)).hex},p.hex2hsv=function(t){return l(p.hex2rgb(t))},p.hex2rgb=function(t){return{r:parseInt(t.substr(1,2),16),g:parseInt(t.substr(3,2),16),b:parseInt(t.substr(5,2),16)}},p.prototype.setHsv=function(t){return h(this,t)},p.prototype.setRgb=function(t){return h(this,l(t),t)},p.prototype.setHex=function(t){return h(this,p.hex2hsv(t),n,t)},p.positionIndicators=function(t,e,n,a){n&&(t.style.top=n.y-t.offsetHeight/2+"px"),a&&(e.style.top=a.y-e.offsetHeight/2+"px",e.style.left=a.x-e.offsetWidth/2+"px")},p.fixIndicators=function(t,e){e.style.pointerEvents="none",t.style.pointerEvents="none"},t.ColorPicker=p}(window,window.document);var LZString=function(){var t=String.fromCharCode,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",a={};function o(t,e){if(!a[t]){a[t]={};for(var n=0;n<t.length;n++)a[t][t.charAt(n)]=n}return a[t][e]}var i={compressToBase64:function(t){if(null==t)return"";var n=i._compress(t,6,(function(t){return e.charAt(t)}));switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:i._decompress(t.length,32,(function(n){return o(e,t.charAt(n))}))},compressToUTF16:function(e){return null==e?"":i._compress(e,15,(function(e){return t(e+32)}))+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:i._decompress(t.length,16384,(function(e){return t.charCodeAt(e)-32}))},compressToUint8Array:function(t){for(var e=i.compress(t),n=new Uint8Array(2*e.length),a=0,o=e.length;a<o;a++){var r=e.charCodeAt(a);n[2*a]=r>>>8,n[2*a+1]=r%256}return n},decompressFromUint8Array:function(e){if(null==e)return i.decompress(e);for(var n=new Array(e.length/2),a=0,o=n.length;a<o;a++)n[a]=256*e[2*a]+e[2*a+1];var r=[];return n.forEach((function(e){r.push(t(e))})),i.decompress(r.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":i._compress(t,6,(function(t){return n.charAt(t)}))},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),i._decompress(t.length,32,(function(e){return o(n,t.charAt(e))})))},compress:function(e){return i._compress(e,16,(function(e){return t(e)}))},_compress:function(t,e,n){if(null==t)return"";var a,o,i,r={},s={},l="",c="",u="",d=2,p=3,f=2,m=[],h=0,g=0;for(i=0;i<t.length;i+=1)if(l=t.charAt(i),Object.prototype.hasOwnProperty.call(r,l)||(r[l]=p++,s[l]=!0),c=u+l,Object.prototype.hasOwnProperty.call(r,c))u=c;else{if(Object.prototype.hasOwnProperty.call(s,u)){if(u.charCodeAt(0)<256){for(a=0;a<f;a++)h<<=1,g==e-1?(g=0,m.push(n(h)),h=0):g++;for(o=u.charCodeAt(0),a=0;a<8;a++)h=h<<1|1&o,g==e-1?(g=0,m.push(n(h)),h=0):g++,o>>=1}else{for(o=1,a=0;a<f;a++)h=h<<1|o,g==e-1?(g=0,m.push(n(h)),h=0):g++,o=0;for(o=u.charCodeAt(0),a=0;a<16;a++)h=h<<1|1&o,g==e-1?(g=0,m.push(n(h)),h=0):g++,o>>=1}0==--d&&(d=Math.pow(2,f),f++),delete s[u]}else for(o=r[u],a=0;a<f;a++)h=h<<1|1&o,g==e-1?(g=0,m.push(n(h)),h=0):g++,o>>=1;0==--d&&(d=Math.pow(2,f),f++),r[c]=p++,u=String(l)}if(""!==u){if(Object.prototype.hasOwnProperty.call(s,u)){if(u.charCodeAt(0)<256){for(a=0;a<f;a++)h<<=1,g==e-1?(g=0,m.push(n(h)),h=0):g++;for(o=u.charCodeAt(0),a=0;a<8;a++)h=h<<1|1&o,g==e-1?(g=0,m.push(n(h)),h=0):g++,o>>=1}else{for(o=1,a=0;a<f;a++)h=h<<1|o,g==e-1?(g=0,m.push(n(h)),h=0):g++,o=0;for(o=u.charCodeAt(0),a=0;a<16;a++)h=h<<1|1&o,g==e-1?(g=0,m.push(n(h)),h=0):g++,o>>=1}0==--d&&(d=Math.pow(2,f),f++),delete s[u]}else for(o=r[u],a=0;a<f;a++)h=h<<1|1&o,g==e-1?(g=0,m.push(n(h)),h=0):g++,o>>=1;0==--d&&(d=Math.pow(2,f),f++)}for(o=2,a=0;a<f;a++)h=h<<1|1&o,g==e-1?(g=0,m.push(n(h)),h=0):g++,o>>=1;for(;;){if(h<<=1,g==e-1){m.push(n(h));break}g++}return m.join("")},decompress:function(t){return null==t?"":""==t?null:i._decompress(t.length,32768,(function(e){return t.charCodeAt(e)}))},_decompress:function(e,n,a){var o,i,r,s,l,c,u,d=[],p=4,f=4,m=3,h="",g=[],v={val:a(0),position:n,index:1};for(o=0;o<3;o+=1)d[o]=o;for(r=0,l=Math.pow(2,2),c=1;c!=l;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=a(v.index++)),r|=(s>0?1:0)*c,c<<=1;switch(r){case 0:for(r=0,l=Math.pow(2,8),c=1;c!=l;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=a(v.index++)),r|=(s>0?1:0)*c,c<<=1;u=t(r);break;case 1:for(r=0,l=Math.pow(2,16),c=1;c!=l;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=a(v.index++)),r|=(s>0?1:0)*c,c<<=1;u=t(r);break;case 2:return""}for(d[3]=u,i=u,g.push(u);;){if(v.index>e)return"";for(r=0,l=Math.pow(2,m),c=1;c!=l;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=a(v.index++)),r|=(s>0?1:0)*c,c<<=1;switch(u=r){case 0:for(r=0,l=Math.pow(2,8),c=1;c!=l;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=a(v.index++)),r|=(s>0?1:0)*c,c<<=1;d[f++]=t(r),u=f-1,p--;break;case 1:for(r=0,l=Math.pow(2,16),c=1;c!=l;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=a(v.index++)),r|=(s>0?1:0)*c,c<<=1;d[f++]=t(r),u=f-1,p--;break;case 2:return g.join("")}if(0==p&&(p=Math.pow(2,m),m++),d[u])h=d[u];else{if(u!==f)return null;h=i+i.charAt(0)}g.push(h),d[f++]=i+h.charAt(0),i=h,0==--p&&(p=Math.pow(2,m),m++)}}};return i}();"function"==typeof define&&define.amd?define((function(){return LZString})):"undefined"!=typeof module&&null!=module?module.exports=LZString:"undefined"!=typeof angular&&null!=angular&&angular.module("LZString",[]).factory("LZString",(function(){return LZString}))
/*!
 * Brush Ninja.
 * https://brush.ninja
 */;var dimensions={square:{label:"Square Canvas (1:1)",description:"Classic Brush Ninja, great for Instagram.",size:[512,512]},comic:{label:"Comic Creator Page",description:"Create images that can be used in the Brush Ninja Comic Creator.",size:[420,574]},traditional:{label:"Traditional TV (4:3)",description:"For that retro tv look. Works well on Twitter and Facebook.",size:[600,450]},widescreen:{label:"Widescreen TV (16:9)",description:"For dramatic movie style creations.",size:[700,390]},cinema:{label:"Cinema",description:"Half the size of an HD resolution - 1920x1080",size:[960,540]}},demoFiles=[{file:"bouncy-ball",name:"Bouncy Ball"},{file:"snowman",name:"Snowman"},{file:"2020-2021-happy-new-year",name:"Happy New Year 2021"}],emoji_icons=["😃","🙁","😇","😂","🥸","😸","💯","❤️","🎁","🍕","💩","👍","🥑","🌈","🦄","🌻"],settingsLinePatterns={solid:[],dots:[0,2],dashes:[1,2]},settingsPalette=["#ffffff","#999999","#000000","#E06F8B","#BE2633","#7a5226","#EB8931","#F7E26B","#A3CE27","#3d722c","#195d8a","#31A2F2","#B2DCEF","transparent"],push_ads=[{title:"Need a new look?",image:"tshirt.png",description:'Support Brush Ninja - <a href="'.concat(ninja_urls.online_store,'">Buy a TShirt</a>.')},{title:"Get Brush Ninja News",image:"email.png",description:'Say up to date - <a href="https://brush.ninja/newsletter/">Get the free newsletter</a>.'},{title:"Keep Brush Ninja Free",image:"gift.png",description:'<a href="'.concat(ninja_urls.patreon,'">Sponsor Brush Ninja on Patreon</a>.')}],settingsToolTabs={tools:[{tab:"select",title:"Select, Move and Rotate"},{tab:"brushes",title:"Paint Brushes"},{tab:"shapes",title:"Shapes and Stickers"},{tab:"lines",title:"Lines"},{tab:"text",title:"Text"}]},settingsToolType={brushes:{PencilBrush:"Pencil","PencilBrush-smooth":"Smooth","PencilBrush-dots":"Dot","PencilBrush-dashes":"Dash",SpeedBrush:"Speed",MarkerBrush:"Marker",ScratchBrush:"Scratch",EraserBrush:"Eraser"},lines:{solid:"Solid",dots:"Dots",dashes:"Dashes"},text:{arial:"Arial","comic-sans":"Comic Sans MS",times:"Times New Roman",courier:"Courier New",impact:"Impact"},shapes:{square:"Square",circle:"Circle",triangle:"Triangle","star-5":"Star",heart:"Heart","robot-head-1":"Robot Head",more:"More +"}},settingsBrushSizes={tiny:{value:1,icon:"brush-tiny"},small:{value:4,icon:"brush-small"},standard:{value:8,icon:"brush-standard"},medium:{value:16,icon:"brush-medium"},large:{value:32,icon:"brush-large"},huge:{value:48,icon:"brush-huge"}},settingsTools={select:{layers:{value:"layers",type:"action-icon",icon:"button-layers",title:"Select object from a list"},"spacer-0":{type:"spacer"},delete:{value:"delete",type:"action",title:"Delete selected object(s)"},duplicate:{value:"duplicate",type:"action",title:"Duplicate object(s)"},"spacer-1":{type:"spacer"},group:{value:"group",type:"action",title:"Group objects into a single object"},ungroup:{value:"ungroup",type:"action",title:"Split a group into separate objects"},"spacer-2":{type:"spacer"},flipH:{value:"flip h",type:"action",title:"Flip the selection horizontally"},flipV:{value:"flip v",type:"action",title:"Flip the selection vertically"},"spacer-3":{type:"spacer"},bringForward:{value:"bring forward",type:"action",title:"Raise the object above the next object in the stack"},sendBackward:{value:"send back",type:"action",title:"Send the object below the previous object in the stack"}},brushes:settingsBrushSizes,shapes:{tiny:{value:1,icon:"brush-tiny"},small:{value:4,icon:"brush-small"},standard:{value:8,icon:"brush-standard"},medium:{value:16,icon:"brush-medium"},large:{value:32,icon:"brush-large"}},lines:settingsBrushSizes,text:{addText:{value:"Add Text",type:"action-icon",icon:"button-edit-text",title:"Add text to frame"},"spacer-1":{type:"spacer"},small:{value:12,icon:"brush-small-text"},medium:{value:24,icon:"brush-medium-text"},large:{value:36,icon:"brush-large-text"},huge:{value:48,icon:"brush-huge-text"}}},settingsExport={options:[{action:"gif",label:"Export as Animated Gif",description:"To share on social media or with a teacher."}],more:[{action:"twitter-gif",label:"Export Twitter Animated Gif",description:"Twitter adds a pause at the end of animated Gifs so they don't loop smoothly. This fixes that."},{action:"image",label:"Export an Image",description:"A single image with each frame laid out in a grid."},{action:"comic",label:"Export a Comic",description:"A single image with each frame laid out in a grid with black borders between frames."},{action:"image-sequence",label:"Export an Image Sequence",description:"A zip file containing individual images for each frame."}]},ninjaDataDefault={activeToolTab:"brushes",activeToolType:{brushes:"PencilBrush",lines:"solid",shapes:"square",text:"arial"},activeTools:{brushes:"standard",lines:"standard",shapes:"standard",text:"medium",select:""}},fileDataDefault={filename:"animation",background:{type:"background-color",data:"#ffffff"},dimensions:"square",activeColor:3,activeFill:13,pickType:"line",pickColor:"#000000",pickOpacity:100,currentFrame:null,frames:[],frameRate:6,frameRateValue:16,displayCaptions:!1,palette:[].concat(settingsPalette),credits:"#BrushNinja"},playbackDataDefault={playing:!1,frame:0};Array.prototype.clone=function(){for(var t=this.slice(0),e=0;e<this.length;e++)this[e].clone&&(t[e]=this[e].clone());return t},Array.prototype.unique=function(){return _toConsumableArray(new Set(this))};var colorMath={tempCanvas:null,tempCanvasCTX:null,brightness:function(t){if(!t)return!0;if("transparent"===t)return!0;if(6!==(t=(t=colorMath.getColor(t)).replace("#","")).length&&3!==t.length)return!1;return 3===t.length&&(t=""+t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),(299*parseInt(""+t[0]+t[1],16)+587*parseInt(""+t[2]+t[3],16)+114*parseInt(""+t[4]+t[5],16))/1e3>130},colorToRGBA:function(t){this.createTempCanvas();var e=this.tempCanvasCTX;return e.fillStyle=t,e.fillRect(0,0,1,1),e.getImageData(0,0,1,1).data},createTempCanvas:function(){this.tempCanvas||(this.tempCanvas=document.createElement("canvas"),this.tempCanvas.height=1,this.tempCanvas.width=1,this.tempCanvasCTX=this.tempCanvas.getContext("2d"))},byteToHex:function(t){return("0"+t.toString(16)).slice(-2)},getColor:function(t){var e=this.colorToRGBA(t);return colorMath.rgbToHex(e)},rgbToHex:function(t){return"#"+[0,1,2].map((function(e){return colorMath.byteToHex(t[e])})).join("")}};function debugComment(t){}function elementSize(t){var e=getComputedStyle(t),n=parseInt(e.marginTop)||0,a=parseInt(e.marginLeft)||0,o=parseInt(e.marginBottom)||0,i=parseInt(e.marginRight)||0;return{height:(parseInt(e.height)||0)+n+o,width:(parseInt(e.width)||0)+a+i}}var sanitize={elem:null,init:function(){this.elem||(this.elem=document.createElement("div"))},html:function(t){return""===t?t:(sanitize.init(),this.elem.textContent=t,this.elem.innerHTML)},attr:function(t){return""===t?t:(sanitize.init(),this.elem.innerHTML=t,this.elem.textContent.replace(/"/g,"&quot;").replace(/'/g,"&#039;"))}},scrollToCenter=function(t,e){var n=t.offsetLeft+t.clientWidth/2,a=e.clientWidth;e.scrollLeft=n-a/2},scrollToTop=function(t,e){var n=t.offsetTop,a=e.offsetTop;e.scrollTop=n-a};function capitalizeFirstLetter(t){return t.charAt(0).toUpperCase()+t.slice(1)}function zeroPadNumber(t,e){return t.toString().padStart(e,"0")}function urlString(t){return t?t.replace(/[^a-z0-9]/gi," ").trim().replace(/  +/g," ").replace(/ +/g,"-").toLowerCase():""}function typeInTextarea(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.activeElement;if(e){e.focus();var n=e.selectionStart,a=e.selectionEnd;e.setRangeText(t,n,a,"end")}}var ninjaEvent=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};document.dispatchEvent(new CustomEvent(t,{detail:e}))},resetAnimation=function(t,e){"webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend".split(" ").forEach((function(n){t.addEventListener(n,(function(t){return t.target.classList.remove(e)}))}))},requireJS={scripts:[],load:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t)if(requireJS.loaded(t))e();else{var n=document.getElementsByTagName("script")[0],a=document.createElement("script");requireJS.scripts.push(t),a.onload=function(){e()},a.src=t,n.parentNode.insertBefore(a,n)}else e()},loaded:function(t){return requireJS.scripts.indexOf(t)>=0}},trackError=function(t){t&&Sentry&&Sentry.captureMessage(t)},unsplash={ajax:{search:"https://api.unsplash.com/search/photos/?query=[query]&per_page=[per_page]&content_filter=high",photo:"https://api.unsplash.com/photos/[id]",download:"https://api.unsplash.com/photos/[id]/download"},client:"b6705cc916c08495b3728630f77e4237fbc48b82e328c2ca50d68a07cf6a9712",request_headers:{},utm_credits:"?utm_source=brush.ninja&utm_medium=referral",queries:{},cache_key:"",ajax_callback:null,init:function(){unsplash.request_headers={"Content-Type":"text/json",Authorization:"Client-ID ".concat(unsplash.client),"Accept-Version":"v1"}},request:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this.init(),null!==n){this.ajax_callback=n;var a=this.ajax[t],o=[];o.push(t),Object.keys(e).forEach((function(t){var n=encodeURIComponent(t),i=encodeURIComponent(e[t]);a=a.replace("[".concat(n,"]"),i),o.push("".concat(n,":").concat(i))})),unsplash.cache_key=o.join("::");var i=this.cache(unsplash.cache_key);i?this.ajax_callback(i):fetch(a,{headers:unsplash.request_headers}).then((function(t){return t.json()})).then(unsplash.success).catch(unsplash.error)}},success:function(t){var e=t.results;unsplash.cache(unsplash.cache_key,e),unsplash.ajax_callback(e)},cache:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return!!this.queries[t]&&this.queries[t];this.queries[t]=e},error:function(t){t&&console.warn(t)},download:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null!=t){this.init();var e=unsplash.ajax.download;e=e.replace("[id]",t),fetch(e,{headers:unsplash.request_headers})}}};function window_size(){var t=window,e=document,n=e.documentElement,a=e.getElementsByTagName("body")[0];return{width:t.innerWidth||n.clientWidth||a.clientWidth,height:t.innerHeight||n.clientHeight||a.clientHeight}}var ninjaData=new Reef(null,{data:_objectSpread({},ninjaDataDefault),lagoon:!0}),ninjaDataReset=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;saveBrowser.disabled=!0,debugComment("ninja-data: Reset the file data."),ninjaData.setData(_objectSpread({},ninjaDataDefault)),fileData.setData(_objectSpread({},fileDataDefault)),painting.setCanvasSize(t),painting.setColor(settingsPalette[fileDataDefault.activeColor]),painting.setFill(settingsPalette[fileDataDefault.activeFill]),painting.drawBackground(),painting.setBrush(ninjaDataDefault.activeToolType.brushes),painting.setBrushSize(settingsTools[ninjaDataDefault.activeToolTab][ninjaDataDefault.activeTools.brushes].value),toolLines.setLinePattern(settingsLinePatterns[ninjaDataDefault.activeToolType.lines]),toolText.setFontFamily(ninjaDataDefault.activeToolType.text),frame.init(),colorPicker.reset(),toolTabs.set("brushes"),saveBrowser.disabled=!1},ninjaDataUpdate=function(){console.log("update data"),fileData.data.frames.length<2?ninjaDataReset():(saveBrowser.disabled=!0,fileData.render(),frame.setFrame(fileData.data.currentFrame,!0),painting.setCanvasSize(fileData.data.dimensions),painting.setColor(fileData.data.palette[fileData.data.activeColor]),null===fileData.data.activeFill?painting.setFill("transparent"):painting.setFill(fileData.data.palette[fileData.data.activeFill]),painting.drawBackground(),toolTabs.set("brushes"),settingsBackground.init(),ninjaEvent("update-background"),saveBrowser.disabled=!1)},fileData=new Reef(null,{data:_objectSpread({},fileDataDefault),lagoon:!0}),playbackData=new Reef(null,{data:_objectSpread({},playbackDataDefault),lagoon:!0}),keyboard={enable:function(){keyboard.disable(),Mousetrap.bind("n",(function(t){return t.preventDefault(),frame.add(),!1})),Mousetrap.bind("d",(function(t){return t.preventDefault(),frame.duplicateCurrent(),!1})),Mousetrap.bind(["shift+del","shift+backspace"],(function(t){return t.preventDefault(),frame.deleteCurrent(),!1})),Mousetrap.bind(["del","backspace"],(function(t){return t.preventDefault(),toolActions.delete(),!1})),Mousetrap.bind(["ctrl+c","command+c"],(function(t){return t.preventDefault(),toolActions.copy(),!1})),Mousetrap.bind(["ctrl+n","command+n"],(function(t){return t.preventDefault(),appNavigation.newEvent(),!1})),Mousetrap.bind(["ctrl+o","command+o"],(function(t){return t.preventDefault(),appNavigation.openEvent(),!1})),Mousetrap.bind(["ctrl+s","command+s"],(function(t){return t.preventDefault(),appNavigation.exportEvent(),!1})),Mousetrap.bind(["ctrl+a","command+a"],(function(t){if(t.preventDefault(),"select"===ninjaData.data.activeToolTab)return toolActions.selectAll(),!1})),Mousetrap.bind(["ctrl+v","command+v"],(function(t){return t.preventDefault(),toolActions.paste(),!1})),Mousetrap.bind(["ctrl+x","command+x"],(function(t){return t.preventDefault(),toolActions.cut(),!1})),Mousetrap.bind("r",(function(t){return t.preventDefault(),toolActions.deleteAll(),!1})),Mousetrap.bind("space",(function(t){return t.preventDefault(),playback.toggle(),!1})),Mousetrap.bind("up",(function(t){return t.preventDefault(),toolActions.nudge(null,-2),!1})),Mousetrap.bind("shift+up",(function(t){return t.preventDefault(),toolActions.nudge(null,-15),!1})),Mousetrap.bind("down",(function(t){return t.preventDefault(),toolActions.nudge(null,2),!1})),Mousetrap.bind("shift+down",(function(t){return t.preventDefault(),toolActions.nudge(null,15),!1})),Mousetrap.bind("left",(function(t){return t.preventDefault(),toolActions.nudge(-2),!1})),Mousetrap.bind("shift+left",(function(t){return t.preventDefault(),toolActions.nudge(-15),!1})),Mousetrap.bind("right",(function(t){return t.preventDefault(),toolActions.nudge(2),!1})),Mousetrap.bind("shift+right",(function(t){return t.preventDefault(),toolActions.nudge(15),!1})),Mousetrap.bind(["ctrl+z","command+z"],(function(t){return t.preventDefault(),fileUndo.undo(),fileUndo.updateButtons(),!1})),Mousetrap.bind(["ctrl+shift+z","command+shift+z","ctrl+y","command+y"],(function(t){return t.preventDefault(),fileUndo.redo(),fileUndo.updateButtons(),!1})),Mousetrap.bind(["ctrl+g","command+g"],(function(t){return t.preventDefault(),toolActions.group(),!1})),Mousetrap.bind(["ctrl+u","command+u"],(function(t){return t.preventDefault(),toolActions.ungroup(),!1})),Mousetrap.bind("j",(function(t){return t.preventDefault(),frame.prev(),!1})),Mousetrap.bind("k",(function(t){return t.preventDefault(),frame.next(),!1})),Mousetrap.bind("f",(function(t){return t.preventDefault(),frame.setFirstFrame(),!1}));var t=0;settingsToolTabs.tools.forEach((function(e){t++,Mousetrap.bind(t.toString(),(function(t){return t.preventDefault(),toolTabs.set(e.tab),!1}))})),Mousetrap.bind("o",(function(t){return t.preventDefault(),appNavigation.onionEvent(),!1}))},disable:function(){Mousetrap.reset()}},settingsBackground={initialized:!1,background:null,init:function(){settingsBackground.initialized||(settingsBackground.initialized=!0,settingsBackground.background=new Image,document.addEventListener("update-background",settingsBackground.updateBackgroundImage),settingsBackground.updateBackgroundImage())},show:function(){settingsBackground.init();var t="#modal-settings-background";document.querySelectorAll(t+" section button").forEach((function(t){t.getAttribute("data-has-events")||(t.setAttribute("data-has-events","true"),t.addEventListener("click",settingsBackground.click),t.addEventListener("touchstart",settingsBackground.click))})),modal.show(t)},click:function(t){var e=t.target.getAttribute("data-target");if(e){var n=window["settingsBackground"+e];n&&n.run(t)}},updateBackgroundImage:function(){var t=fileData.data.background;console.log("settings type",t.type),"background-image"===t.type&&(console.log("update background image",t.data),settingsBackground.background.src=t.data)}},settingsBackgroundColor={picker:null,pickerType:"background-color",init:function(){null===this.picker&&(this.picker=new customColorPicker(".settings-background-color-picker",settingsBackgroundColor.pickerType,!1),document.addEventListener("select-color-picker-color",settingsBackgroundColor.selectColorPickerColorEvent))},run:function(){modal.show("#modal-settings-background-colorpicker"),this.init()},selectColorPickerColorEvent:function(t){if(settingsBackgroundColor.pickerType===t.detail.type){var e={type:"background-color",data:t.detail.color};debugComment("settings-background-colorpicker: set the background color."),fileData.setData({background:e}),ninjaEvent("update-background")}}},settingsBackgroundReset={run:function(){this.reset(),modal.reset()},reset:function(){debugComment("settings-background-reset: reset the background."),fileData.setData({background:{type:"transparent",data:""}}),ninjaEvent("update-background")}},settingsBackgroundTexture={run:function(t){var e=t.target.getAttribute("data-pattern"),n="/assets/images/paper/".concat(e,"-").concat(fileData.data.dimensions,".png"),a=new Image;a.setAttribute("crossOrigin","anonymous"),a.onload=function(){var t=document.createElement("canvas");t.width=a.width,t.height=a.height,t.getContext("2d").drawImage(a,0,0);var e=t.toDataURL("image/jpeg",.85);debugComment("background-image-texture: Set the background."),fileData.setData({background:{type:"background-image",data:e}}),ninjaEvent("update-background"),t.remove(),this.remove(),modal.reset()},a.src=n}},settingsBackgroundUnsplash={$searchInput:null,debounce:null,search_amount:24,init:function(){null===this.$searchInput&&(this.$searchInput=document.querySelector("#search-unsplash"),this.$searchInput.addEventListener("keyup",this.initSearch),unsplashImageList.init())},run:function(){modal.show("#modal-settings-background-unsplash"),settingsBackgroundUnsplash.init(),setTimeout((function(){return document.querySelector("#search-unsplash").focus()}),100)},initSearch:function(){var t=settingsBackgroundUnsplash.$searchInput.value.trim();t&&(debugComment("settings-background-unsplash: change to loading mode"),unsplashImageList.app.setData({mode:"loading"}),clearTimeout(settingsBackgroundUnsplash.debounce),settingsBackgroundUnsplash.debounce=setTimeout((function(){settingsBackgroundUnsplash.search(t)}),1e3))},search:function(t){unsplash.request("search",{query:t,per_page:settingsBackgroundUnsplash.search_amount},settingsBackgroundUnsplash.results)},results:function(t){debugComment("settings-backgrund-unsplash: list search results"),unsplashImageList.app.setData({mode:"list",data:t})}},settingsBackgroundUpload={initialized:!1,init:function(){this.initialized||backgroundImageUploader.init()},run:function(){this.init(),modal.show("#modal-settings-background-upload")}},settingsBackgroundWebcam={initialized:!1,init:function(){this.initialized||backgroundImageWebcam.init()},run:function(){this.init(),modal.show("#modal-settings-background-webcam")}},saveBrowser={timeout:null,worker:null,changed:!1,saving:!1,count:0,countTime:0,delay:2500,disabled:!0,init:function(){saveBrowser.worker=new Worker("/assets/build/local-save.min.js"),saveBrowser.worker.onmessage=saveBrowser.workComplete,saveBrowser.date=new Date,console.log("init save browser"),document.addEventListener("reef-set-data",saveBrowser.trackChanges)},closeWindow:function(t){(saveBrowser.changed||saveBrowser.saving)&&(t.returnValue="",t.preventDefault())},trackChanges:function(t){if(!saveBrowser.disabled&&t.detail.frames&&!(t.detail.frames.length<1)){var e=new Date;saveBrowser.countTime>e.getTime()-saveBrowser.delay/10||(saveBrowser.reset(),saveBrowser.timeout=setTimeout(saveBrowser.saveLocal,saveBrowser.delay),saveBrowser.countTime=e.getTime(),saveBrowser.changed=!0)}},saveLocal:function(){saveBrowser.reset(),ninjaEvent("save-start"),saveBrowser.saving||(saveBrowser.count++,console.log("save start",fileData.data),saveBrowser.worker.postMessage({action:"save",data:fileData.data}),ninjaEvent("save-processed"),saveBrowser.saving=!0)},loadLocal:function(){saveBrowser.worker.postMessage({action:"load"})},workComplete:function(t){var e=t.data,n=e.action,a=e.data;return"saved"===n?(ninjaEvent("save-complete"),saveBrowser.count--,saveBrowser.saving=!1,void console.log("save complete",saveBrowser.count)):"loaded"===n?(saveBrowser.disabled=!0,debugComment("save-browser: load browser data."),fileData.setData(a),saveBrowser.disabled=!1,void ninjaDataUpdate()):void 0},reset:function(){clearTimeout(saveBrowser.timeout)}},importFile={initialized:!1,init:function(){this.initialized||(this.initialized=!0,fileOpen.init())},show:function(){fileOpen.init(),modal.show("#modal-load-file")}},exportFile={download_link:"",generate:function(){var t=fileFormat.get(fileData.data),e=new Blob([t],{type:"text/plain;charset=utf-8"});exportFile.generateLink(e)},generateLink:function(t){exportFile.blob=t,exportFile.get_download_link(),setTimeout(exportFile.stop,saveAnimation.saveDelay)},get_download_link:function(){return exportFile.blob?(exportFile.download_link=exportAnimation.link("brushninja","Save File",exportFile.blob),exportFile.download_link):""},stop:function(){debugComment("export-file: stop processing"),saveAnimation&&exportFile.download_link&&saveAnimation.app.setData({status:"download",data:exportFile.download_link})}},exportStacks={current:null,callback:null,_canvases:[],canvases:[],frames:[],minimum_length:5e3,display_credits:!0,caption_font:"16px Arial",generate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"16px Arial";t&&(exportStacks.callback=t,exportStacks.frames=frame.getFrames(),exportStacks.minimum_length=e,exportStacks.display_credits=n,exportStacks.caption_font=a,exportStacks.maybeCreateFrame())},maybeCreateFrame:function(){if(exportStacks.frames.length<=0)exportStacks.process();else{var t=exportStacks.frames.shift();exportStacks.createFrame(t)}},process:function(){var t=playback.totalTime(),e=1;exportStacks.minimum_length>1e3&&(e=Math.ceil(exportStacks.minimum_length/t));for(var n=1;n<=e;n++){var a;(a=exportStacks.canvases).push.apply(a,_toConsumableArray(exportStacks._canvases))}exportStacks.callback&&exportStacks.callback()},createFrame:function(t){var e=frame.getImage(t.id),n=fileData.data,a=painting.createCanvas(),o=painting.canvas.width,i=painting.canvas.height,r=a.getContext("2d");painting.drawCanvasBackground(r),"transparent"===n.background.type&&(e=exportStacks.removeAntiAliasing(e)),r.drawImage(e,0,0),"displayCaptions"in n&&!0===n.displayCaptions&&"notes"in t&&t.length>0&&exportStacks.displayCaption(t,r,o,i),settings.creditsOverlay&&exportStacks.display_credits&&r.drawImage(settings.creditsOverlay,0,0),"transparent"===n.background.type&&e.remove(),exportStacks._canvases.push({canvas:a,delay:playback.interval(t)}),exportStacks.maybeCreateFrame()},displayCaption:function(t,e,n,a){e.font=exportStacks.caption_font;var o=24,i=wrapText.prepare(e,t.notes,n-o-o),r=wrapText.height(i,24)+o+o;e.fillStyle="rgba(0,0,0,0.8)",e.fillRect(0,a-r,n,r),e.fillStyle="#ffffff",wrapText.display(e,i,o,a-o,24,wrapText.ALIGN_BOTTOM)},removeAntiAliasing:function(t){var e=document.createElement("canvas");e.width=painting.canvas.width,e.height=painting.canvas.height;var n=e.getContext("2d");n.drawImage(t,0,0);for(var a=n.getImageData(0,0,painting.canvas.width,painting.canvas.height),o=0;o<a.data.length;o+=4){var i=o+3;a.data[i]>128?a.data[i]=255:a.data[i]=0}return n.putImageData(a,0,0),e},reset:function(){exportStacks._canvases.forEach((function(t){return t.canvas.remove()})),exportStacks.canvases.forEach((function(t){return t.canvas.remove()})),exportStacks.canvases=[],exportStacks._canvases=[]}},exportComic={download_link:"",gutter:20,background:"transparent",maxSize:2500,canvas:null,generate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"transparent",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;exportComic.gutter=e,exportComic.background=t,exportStacks.generate(exportComic.stackCallback,0,!1,"12pt Comic Sans MS")},stackCallback:function(){var t=exportComic.dimensions();exportComic.draw(t),exportComic.canvas.toBlob(exportComic.generateLink,"image/png")},draw:function(t){var e=this;this.canvas=painting.createCanvas(),this.canvas.width=t.image_width,this.canvas.height=t.image_height;var n=this.canvas.getContext("2d");if("transparent"!==this.background&&(n.fillStyle=this.background,n.fillRect(0,0,t.image_width,t.image_height)),exportStacks.canvases.forEach((function(a,o){var i=0,r=o%t.cols*(t.frame_width+e.gutter)+e.gutter,s=Math.floor(o/t.cols)*(t.frame_height+e.gutter)+e.gutter;Math.floor(o/t.cols)===t.rows-1&&(i=t.last_row_offset),n.drawImage(a.canvas,r+i,s,t.frame_width,t.frame_height)})),settings.creditsOverlay){var a=painting.canvas;n.drawImage(settings.creditsOverlay,t.image_width-a.width-this.gutter,t.image_height-a.height-this.gutter)}},dimensions:function(){var t=painting.canvas,e=exportStacks.canvases.length,n=Math.ceil(Math.sqrt(e)),a=Math.ceil(e/n),o=(a+1)*this.gutter,i=(n+1)*this.gutter,r=n*t.width+i,s=((r=Math.min(r,this.maxSize))-i)/n,l=1*s,c=a*l+o;c>this.maxSize&&(r=n*(s=(l=((c=this.maxSize)-i)/a)/1)+i);var u=e%n,d=0;u>0&&(d=(r-u*s-(u-1)*this.gutter)/2);return{image_width:r,image_height:c,frame_width:s,frame_height:l,rows:a,cols:n,last_row_offset:d}},generateLink:function(t){exportStacks.reset(),exportComic.download_link=exportAnimation.link("png","Download Image",t),setTimeout(exportComic.stop,exportAnimation.renderDelay)},stop:function(){debugComment("export-comic: Set export properties."),exportAnimation.app.setData({status:"download",data:exportComic.download_link})}},exportGif={download_link:"",trans_hex:16711934,trans_html:"#ff00fe",twitterExport:!1,scriptPath:"/assets/build/gif.min.js",gifClassic:function(){requireJS.load(exportGif.scriptPath,(function(){exportGif.twitterExport=!1,exportStacks.generate(exportGif.stackCallback)}))},gifTwitter:function(){requireJS.load(exportGif.scriptPath,(function(){exportGif.twitterExport=!0,exportStacks.generate(exportGif.stackCallback)}))},stackCallback:function(){exportGif.gif=exportGif.newGif();var t=exportStacks.canvases.length;exportStacks.canvases.forEach((function(e,n){var a=e.delay;exportGif.twitterExport&&n===t-1&&(a=Math.round(a/2)),exportGif.gif.addFrame(e.canvas,{delay:a})})),exportGif.gif.on("finished",exportGif.generateLink),exportGif.gif.render()},generateLink:function(t){exportStacks.reset(),exportGif.gif&&exportGif.gif.freeWorkers&&exportGif.gif.freeWorkers.forEach((function(t){return t.terminate()})),exportGif.gif=null,exportGif.download_link=exportAnimation.link("gif","Download Animated Gif",t),exportGif.download_link+='\n\t\t\t<div class="button-description">\n\t\t\t\t<a\n\t\t\t\t\thref="/convert-gif-mp4/"\n\t\t\t\t\tclass="button secondary greedy"\n\t\t\t\t\tdata-action="allow-click"\n\t\t\t\t\ttarget="_export">Convert Gif to Video</a>\n\t\t\t\t<p>Save the Gif first. Will open in a new tab</p>\n\t\t\t</div>\n\t\t',setTimeout(exportGif.stop,exportAnimation.renderDelay)},stop:function(){debugComment("export-gif: download settings"),exportAnimation.app.setData({status:"download",data:exportGif.download_link})},newGif:function(){var t=fileData.data,e={workerScript:"/assets/build/gif.worker.min.js",width:painting.canvas.width,height:painting.canvas.height};return"transparent"===t.background.type&&(e.transparent=exportGif.trans_hex),"background-image"===t.background.type&&(e.dither="FloydSteinberg-serpentine"),new GIF(e)}},exportZip={download_link:"",gutter:20,maxSize:2500,canvas:null,generate:function(){requireJS.load("/assets/build/jszip.min.js",(function(){exportStacks.generate(exportZip.stackCallback,0)}))},stackCallback:function(){var t=new JSZip,e=Math.max(exportStacks.canvases.length.toString().length,1);exportStacks.canvases.forEach((function(n,a){var o="frame-".concat(zeroPadNumber(a+1,e),".png");t.file(o,n.canvas.toDataURL("image/png").split(";base64,")[1],{base64:!0})})),t.generateAsync({type:"blob"}).then(exportZip.zipComplete)},zipComplete:function(t){exportZip.generateLink(t)},generateLink:function(t){exportStacks.reset(),exportZip.download_link=exportAnimation.link("zip","Download Image Sequence",t),setTimeout(exportZip.stop,exportAnimation.renderDelay)},stop:function(){debugComment("export-zip: download settings"),exportAnimation.app.setData({status:"download",data:exportZip.download_link})}},fileFormat={VERSION_PREFIX_2:"BNFS0002",get:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return fileFormat.VERSION_PREFIX_2+JSON.stringify(t)},load:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=!1;if(t){var n=t.substring(0,8);if(n===fileFormat.VERSION_PREFIX_2)e=t.slice(fileFormat.VERSION_PREFIX_2.length);else e=LZString.decompressFromEncodedURIComponent(t);if(e=JSON.parse(e),!(e=fileFormat.checkFrames(e))||!e.frames)return alert("Unrecognised File Type or corrupted data."),{}}return e},checkFrames:function(t){if(!t.frames||t.frames.length<=1)return null;var e=[],n=!1;return t.frames.forEach((function(t){t.json&&e.push(t),"new-frame"===t.id&&(e.push(t),n=!0)})),n||e.push({id:"new-frame"}),t.frames=e,t}},appNavigation={init:function(){document.querySelectorAll(".toolbar-menu button").forEach((function(t){t.addEventListener("click",appNavigation.click),t.addEventListener("touchstart",appNavigation.click)}))},click:function(t){t.stopPropagation(),t.preventDefault();var e=t.target.getAttribute("data-action");if(e){var n=appNavigation[e+"Event"];n&&n()}},backgroundEvent:function(){settingsBackground.show()},saveEvent:function(){saveAnimation.run()},undoEvent:function(){fileUndo.undo(),fileUndo.updateButtons()},redoEvent:function(){fileUndo.redo(),fileUndo.updateButtons()},onionEvent:function(){onionSkin.toggle()},newEvent:function(){fileNew.show()},helpEvent:function(){modal.show("#modal-help")},settingsEvent:function(){settings.show()},openEvent:function(){confirm("\nOpening an animation will delete your existing animation.\nDo you want to continue?")&&importFile.show()},exportEvent:function(){exportAnimation.init(),debugComment("app-nav-actions: export event"),exportAnimation.app.setData({status:"menu"}),modal.show("#modal-export-animation")},copyEvent:function(){toolActions.copy()},pasteEvent:function(){toolActions.paste()}},onionSkin={enabled:!1,app:void 0,ctx:null,canvas:null,renderTimer:null,init:function(){onionSkin.canvas=document.querySelector(".onion-skin"),onionSkin.ctx=onionSkin.canvas.getContext("2d"),document.addEventListener("set-frame",onionSkin.render),window.addEventListener("resize",onionSkin.maybeRender),this.enabled=!1,onionSkin.render(),fileData.render()},toggle:function(){this.enabled=!this.enabled;var t=document.getElementById("onion-skin-toggle");this.enabled&&(onionSkin.canvas.classList.add("onion-skin__display"),t.classList.add("selected")),this.enabled||(onionSkin.canvas.classList.remove("onion-skin__display"),t.classList.remove("selected")),onionSkin.render()},maybeRender:function(t){clearTimeout(onionSkin.renderTimer),onionSkin.renderTimer=setTimeout(onionSkin.render,500)},render:function(t){var e=frame.getFrames(),n=onionSkin.ctx;if(onionSkin.canvas&&n&&n.clearRect(0,0,onionSkin.canvas.width,onionSkin.canvas.height),!(e.length<=1)){onionSkin.canvas.width=painting.width(),onionSkin.canvas.height=painting.height();var a=fileData.data.currentFrame,o=e.findIndex((function(t){return a===t.id})),i=onionSkin.getSkinFrames(o,e.length),r=[];i.forEach((function(t){var a=t[0],i=t[1];a!==o&&e[a]&&!r.includes(a)&&(n.globalAlpha=i,n.drawImage(frame.getImage(e[a].id),0,0),r.push(a))}))}},getSkinFrames:function(t,e){return[[onionSkin.wrap(t-1,e),.15],[onionSkin.wrap(t+1,e),.15],[onionSkin.wrap(t-2,e),.05],[onionSkin.wrap(t+2,e),.05],[onionSkin.wrap(t-3,e),.01],[onionSkin.wrap(t+3,e),.01]].unique()},wrap:function(t,e){return t<0&&(t=e+t),t>e-1&&(t-=e),t}},zoom={isEnabled:!0,isDragging:!1,init:function(){painting.canvas.on("mouse:wheel",zoom.wheel)},enable:function(){this.isEnabled=!0},disable:function(){this.isEnabled=!1},wheel:function(t){var e=painting.canvas,n=e.getWidth(),a=e.getHeight(),o=t.e.deltaY,i=e.getZoom();i+=o/200,i=Math.max(i,1),i=Math.min(i,2.5),e.zoomToPoint({x:t.e.offsetX,y:t.e.offsetY},i),t.e.preventDefault(),t.e.stopPropagation();var r=this.viewportTransform;r[4]>=0?this.viewportTransform[4]=0:r[4]<n-n*i&&(this.viewportTransform[4]=n-n*i),r[5]>=0?this.viewportTransform[5]=0:r[5]<a-a*i&&(this.viewportTransform[5]=a-a*i)},move:function(t){if(zoom.isDragging){var e=t.e;this.viewportTransform[4]+=e.clientX-this.lastPosX,this.viewportTransform[5]+=e.clientY-this.lastPosY,this.requestRenderAll(),this.lastPosX=e.clientX,this.lastPosY=e.clientY}},up:function(t){zoom.isDragging=!1}},frame={loading:!1,pulse:null,updateTimeout:null,initialised:!1,init:function(){frame.addNewFrameButton(),frame.add(),fileUndo.init(),frame.loading=!1;var t=document.querySelector(".timeline");frame.initialised||(frame.initialised=!0,frame.addEvents(),resetAnimation(t,"animation-pulse"))},fileUndoEvent:function(t){var e=fileData.data.currentFrame;frame.setFrame(e,!0)},addEvents:function(){painting.canvas.on("object:modified",frame.maybeUpdateImageEvent),painting.canvas.on("selection:cleared",frame.maybeUpdateImageEvent),painting.canvas.on("path:created",frame.maybeUpdateImageEvent),document.addEventListener("object-added",frame.maybeUpdateImageEvent),document.addEventListener("object-coloured",frame.maybeUpdateImageEvent),painting.canvas.on("mouse:down",frame.donotUpdateImageEvent),document.addEventListener("fileUndo",this.fileUndoEvent)},removeEvents:function(){painting.canvas.off("object:modified",frame.maybeUpdateImageEvent),painting.canvas.off("selection:cleared",frame.maybeUpdateImageEvent),painting.canvas.off("path:created",frame.maybeUpdateImageEvent),painting.canvas.off("mouse:down",frame.donotUpdateImageEvent),document.removeEventListener("object-added",frame.maybeUpdateImageEvent),document.removeEventListener("object-coloured",frame.maybeUpdateImageEvent)},template:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!t)return"";var a=!1;t&&t.id===n&&(a=!0);var o=dimensions[fileData.data.dimensions].size,i='\n\t\t\t<section\n\t\t\t\tid="frame-'.concat(t.id,'"\n\t\t\t\tclass="frame drag"\n\t\t\t\tdata-selected="').concat(a,'"\n\t\t\t\tdata-index="').concat(t.id,'"\n\t\t\t>\n\n\t\t\t\t<header class="frame__length">\n\t\t\t\t\t').concat(frame.templateLength(t.id,t.length),'\n\t\t\t\t</header>\n\n\t\t\t\t<img\n\t\t\t\t\tclass="frame-image-').concat(t.id,'"\n\t\t\t\t\talt="*"\n\t\t\t\t\tsrc="').concat(t.image,'"\n\t\t\t\t\twidth="').concat(o[0],'"\n\t\t\t\t\theight="').concat(o[1],'"\n\t\t\t\t\tstyle="aspect-ratio: ').concat(o[0],"/").concat(o[1],';"\n\t\t\t\t/>\n\n\t\t\t\t<footer class="frame__tools">\n\t\t\t\t\t').concat(frame.templateButtons(t.id),"\n\t\t\t\t</footer>\n\n\t\t\t</section>\n\t\t\t");return i},templateButtons:function(t){var e="";return e+='\n\t\t\t<button\n\t\t\t\tclass="tool-duplicate"\n\t\t\t\tdata-index="'.concat(t,'"\n\t\t\t\ttitle="Duplicate (D)"\n\t\t\t>\n\t\t\t\t').concat(SVGIcons["button-duplicate"],'\n\t\t\t\t<span class="screen-reader-text">Duplicate Frame ').concat(t,"</span>\n\t\t\t</button>"),frame.count()>1&&(e+='\n\t\t\t\t<button\n\t\t\t\t\tclass="tool-delete"\n\t\t\t\t\tdata-index="'.concat(t,'"\n\t\t\t\t\ttitle="Delete (Del/ Backspace)"\n\t\t\t\t>\n\t\t\t\t\t').concat(SVGIcons["button-trash"],'\n\t\t\t\t\t<span class="screen-reader-text">Delete Frame ').concat(t,"</span>\n\t\t\t\t</button>")),e},templateLength:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n="";return e&&void 0!==e||(e=1),frame.pulse===t&&(n="animation-pulse",frame.pulse=null),'\n\t\t\t<button\n\t\t\t\tdata-index="'.concat(t,'"\n\t\t\t\tclass="length-decrease"\n\t\t\t\ttitle="Decrease Length of Frame"\n\t\t\t>\n\t\t\t\t-\n\t\t\t\t<span class="screen-reader-text">Decrease Length of Frame ').concat(t,'</span>\n\t\t\t</button>\n\t\t\t<span class="mult ').concat(n,'">x').concat(e,'</span>\n\t\t\t<button\n\t\t\t\tdata-index="').concat(t,'"\n\t\t\t\tclass="length-increase"\n\t\t\t\ttitle="Increase Length of Frame"\n\t\t\t>\n\t\t\t\t+\n\t\t\t\t<span class="screen-reader-text">Increase Length of Frame ').concat(t,"</span>\n\t\t\t</button>\n\t\t\t")},add:function(){var t=_toConsumableArray(fileData.data.frames),e=frame.getNewFrameID(),n=frame.getDefault();t.splice(e,0,n),debugComment("frame: add new frame."),fileData.setData({frames:t}),frame.setFrame(n.id)},addNewFrameButton:function(){var t=_toConsumableArray(fileData.data.frames);frame.getNewFrameID()>-1||(t.push({id:"new-frame"}),debugComment("frame: add a new frame button"),fileData.setData({frames:t}))},count:function(){return fileData.data.frames.length-1},increase:function(t){var e=_toConsumableArray(fileData.data.frames),n=frame.getID(t);e[n].length=Math.min(99,e[n].length+1),frame.pulse=t,debugComment("frame: increase the length of the current frame"),fileData.setData({frames:e})},decrease:function(t){var e=_toConsumableArray(fileData.data.frames),n=frame.getID(t);e[n].length=Math.max(1,e[n].length-1),frame.pulse=t,debugComment("frame: decrease the length of the current frame"),fileData.setData({frames:e})},get:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=frame.getID(t);return fileData.data.frames[e]},getID:function(t){return fileData.data.frames.findIndex((function(e){return!!e&&t===e.id}))},getNewFrameID:function(){return fileData.data.frames.findIndex((function(t){return!!t&&"new-frame"===t.id}))},getPosition:function(t){return frame.getFrames().findIndex((function(e){return!!e&&t===e.id}))},getCurrentID:function(){var t=fileData.data.currentFrame;return frame.getID(t)},getCurrentFrame:function(){var t=fileData.data.currentFrame;return frame.get(t)},getFrames:function(){return _toConsumableArray(fileData.data.frames).filter((function(t){return!!t&&"new-frame"!==t.id}))},getImage:function(t){return document.querySelector(".frame-image-".concat(t))},setFrame:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=fileData.data.currentFrame;if(t!==n||e){var a=painting.canvas;ninjaEvent("set-frame-start"),t!==n&&(debugComment("frame: set the current frame"),fileData.setData({currentFrame:t})),ninjaEvent("set-frame",{index:t});var o=frame.get(t);o&&o.json&&(frame.loading=!0,a.renderOnAddRemove=!1,a.loadFromJSON(o.json),a.renderOnAddRemove=!0,frame.loading=!1,playbackData.render(),ninjaEvent("set-frame-complete"),setTimeout((function(){var t=document.querySelector(".frame[data-selected='true']"),e=document.querySelector(".timeline");t&&scrollToCenter(t,e)}),100))}},maybeUpdateImageEvent:function(){frame.donotUpdateImageEvent(),frame.updateTimeout=setTimeout(frame.updateImageEvent,200)},donotUpdateImageEvent:function(){clearTimeout(frame.updateTimeout)},updateImageEvent:function(){if(!frame.loading){ninjaEvent("update-image-start");var t=fileData.data,e=_toConsumableArray(t.frames),n=frame.get(t.currentFrame),a=frame.getID(t.currentFrame);n&&(n.image=painting.canvas.toDataURL({format:"png"}),n.json=JSON.stringify(painting.canvas.toDatalessJSON()),ninjaEvent("update-image-complete"),e[a]=_objectSpread({},n),debugComment("frame: update the frame thumbnail."),fileData.setData({frames:e}))}},deleteCurrent:function(){var t=fileData.data.currentFrame;frame.delete(t)},delete:function(t){if(!(frame.count()<=1)){var e=_toConsumableArray(fileData.data.frames),n=frame.getID(t);e.splice(n,1),debugComment("frame: delete new frame."),fileData.setData({frames:e}),n&&frame.setCurrentFrame(n)}},duplicateCurrent:function(){var t=fileData.data.currentFrame;frame.duplicate(t)},duplicate:function(t){var e=_toConsumableArray(fileData.data.frames),n=frame.getID(t)+1,a=_objectSpread({},frame.get(t));a.id=frame.getUniqueId(),e.splice(n,0,a),debugComment("frame: duplicate the current frame."),fileData.setData({frames:e}),frame.setFrame(a.id)},move:function(t,e){var n=_toConsumableArray(fileData.data.frames);n.splice(e,0,n.splice(t,1)[0]),debugComment("frame: Move the current frame."),fileData.setData({frames:n})},setCurrentFrame:function(t){var e=fileData.data,n=frame.count(),a=null;(a=frame.getFrameAt(t))&&a.id===e.currentFrame||(a&&a.id!==e.currentFrame?this.setFrame(a.id):1!==n?t>=n?this.setFrame(frame.getFrameAt(n-1).id):((a=frame.getFrameAt(t+1))||(a=frame.getFrameAt(t-1)))&&this.setFrame(a.id):this.setFrame(frame.getFrameAt(0).id))},next:function(){var t=frame.getCurrentID(),e=frame.getFrameAt(t+1);e&&this.setFrame(e.id)},prev:function(){var t=frame.getCurrentID(),e=frame.getFrameAt(t-1);e&&this.setFrame(e.id)},setFirstFrame:function(){var t=frame.getCurrentID();if(!(t<=0)){var e=fileData.data.frames,n=e.slice(0,t),a=e.slice(t,e.length).concat(n);debugComment("frame: set the first frame."),fileData.setData({frames:a})}},getFrameAt:function(t){var e=fileData.data.frames,n=e[t];return n&&"new-frame"===n.id&&(n=e[t-1]),n||(n=e[t+1]),n||(n=e[t-1]),n},getDefault:function(){return{id:frame.getUniqueId(),image:"/assets/images/blank.png",json:"{}",length:1,notes:""}},getUniqueId:function(){var t=fabric.util.getRandomInt(1111,9999),e=(new Date).getTime()+"",n=e.substr(e.length-4);return"".concat(t,"-").concat(n)}},fileUndo={history:[],future:[],changeTimeout:null,renderTimeout:null,ignoreRenderEvent:!1,delay:150,init:function(){fileUndo.reset(),document.addEventListener("reef-set-data",fileUndo.trackChanges)},trackChanges:function(t){t.detail.frames&&(clearTimeout(fileUndo.changeTimeout),fileUndo.changeTimeout=setTimeout(fileUndo.add,fileUndo.delay))},ignoreRender:function(){fileUndo.ignoreRenderEvent=!0,clearTimeout(fileUndo.renderTimeout),fileUndo.renderTimeout=setTimeout((function(){fileUndo.ignoreRenderEvent=!1}),2*fileUndo.delay)},add:function(){if(!0!==fileUndo.ignoreRenderEvent){var t=JSON.stringify(fileData.data.frames);fileUndo.history.unshift(t);var e=fileUndo.max_length();fileUndo.history.length>e&&(fileUndo.history.length=e),fileUndo.future.length=0,fileUndo.updateButtons()}},undo:function(){if(!(fileUndo.history.length<=1)){ninjaEvent("undo-start");var t=fileUndo.history.shift();fileUndo.future.unshift(t),debugComment("undo: undo the frames"),fileData.setData({frames:JSON.parse(fileUndo.history[0])}),fileData.render(),ninjaEvent("fileUndo",{type:"undo"}),ninjaEvent("undo-complete"),fileUndo.ignoreRender();var e=frame.getID(fileData.data.currentFrame);frame.setCurrentFrame(e),console.log("Undo to ".concat(e))}},redo:function(){if(!(keyboard.paused||fileUndo.future.length<1)){ninjaEvent("undo-start"),debugComment("undo: redo the frames."),fileData.setData({frames:JSON.parse(fileUndo.future[0])});var t=fileUndo.future.shift();fileUndo.history.unshift(t),ninjaEvent("fileUndo",{type:"redo"}),ninjaEvent("undo-complete"),fileUndo.ignoreRender()}},reset:function(){clearTimeout(fileUndo.changeTimeout),clearTimeout(fileUndo.renderTimeout),fileUndo.ignoreRenderEvent=!1,fileUndo.add(),fileUndo.history.length=0,fileUndo.future.length=0,fileUndo.updateButtons()},updateButtons:function(){var t=document.querySelector("button[data-action=undo]"),e=document.querySelector("button[data-action=redo]");fileUndo.history.length>1?t.disabled=!1:t.disabled=!0,fileUndo.future.length>0?e.disabled=!1:e.disabled=!0},max_length:function(){var t=41;return t-=frame.count(),t=Math.max(10,t)}},betaCheck={pass:"8723659375834623893847349547923876450",test:function(){return new URLSearchParams(window.location.search).get("p")===this.pass}},modal={visible:!1,history:[],initialised:!1,init:function(){modal.initialised||(document.addEventListener("click",modal.clickEvent),modal.initialised=!0)},add:function(t){var e=document.querySelector(t);if(e&&!e.classList.contains("modal-window")){modal.init(),e.classList.add("modal-window"),modal.wrapContents(e);var n=document.createElement("nav");n.classList.add("modal-nav"),e.insertBefore(n,e.childNodes[0]);var a=document.createElement("button");a.classList.add("modal-close","button","teeny","dark"),a.innerHTML="Close",n.appendChild(a);var o=document.createElement("button");o.classList.add("modal-back","button","teeny","dark"),o.innerHTML="&lsaquo; Back",n.appendChild(o)}},wrapContents:function(t){var e=document.createElement("div");e.classList.add("modal-window-inner"),_toConsumableArray(t.childNodes).forEach((function(t){return e.appendChild(t)})),t.appendChild(e)},show:function(t){if(!modal.history||t!==modal.history[modal.history.length-1]){modal.add(t);var e=document.querySelector(t);if(e&&(modal.visible||(modal.history=[]),modal.hide(),!e.classList.contains("modal-visible"))){e.classList.add("modal-visible"),void 0!==keyboard&&keyboard.disable(),modal.addKeyboardSupport(),modal.visible=!0,document.querySelector("body").classList.add("modal-visible"),modal.history.push(t);var n=e.querySelector(".modal-back");n.style.display="none",this.history.length>1&&(n.style.display="block"),e.focus()}}},back:function(){if(this.history.length<=1)this.reset();else{this.history.pop();var t=this.history.pop();this.show(t),ninjaEvent("modal-back")}},hide:function(){void 0!==keyboard&&keyboard.enable(),this.history.length<=1&&(modal.visible=!1,document.querySelector("body").classList.remove("modal-visible")),document.querySelectorAll(".modal-window").forEach((function(t){t.classList.remove("modal-visible")}))},reset:function(){this.history=[],modal.hide(),ninjaEvent("modal-reset")},clickEvent:function(t){var e=t.target;e.classList.contains("modal-window")&&modal.reset(),e.classList.contains("modal-back")&&modal.back(),e.classList.contains("modal-close")&&modal.reset()},addKeyboardSupport:function(){"undefined"!=typeof Mousetrap&&(Mousetrap.bind("escape",(function(t){t.preventDefault(),modal.reset()})),Mousetrap.bind("backspace",(function(t){t.preventDefault(),modal.back()})))}},painting={canvas:null,color:null,fillColor:null,opacity:100,colorPicker:!1,brushSize:null,brushName:"",brushType:"",resizeTimer:null,init:function(){this.canvas=new fabric.Canvas("frame-canvas",{enableRetinaScaling:!1,selectionLineWidth:8,perPixelTargetFind:!0,selection:!1,preserveObjectStacking:!0}),this.canvas.renderAll(),fabric.Object.prototype.transparentCorners=!1,fabric.Object.prototype.snapAngle=5,fabric.Object.prototype.cornerStyle="circle",fabric.Object.prototype.padding=5,fabric.Object.prototype.cornerSize=20,document.addEventListener("change-color",painting.changeColorEvent),document.addEventListener("update-background",painting.updateBackgroundEvent);var t=document.querySelector("#animate-wrapper");t.addEventListener("mousedown",painting.clickEvent,!1),t.addEventListener("touchdown",painting.clickEvent,!1),window.addEventListener("load",painting.resizeEvent,!1),window.addEventListener("resize",painting.resizeEvent,!1),painting.canvas.on("object:added",painting.objectAddedEvent),keyboard.enable(),ninjaEvent("canvas-init")},resizeEvent:function(){clearTimeout(painting.resizeTimer),painting.resizeTimer=setTimeout(painting.resizeCanvas,200)},availableCanvasWidth:function(){var t=window_size().width,e=elementSize(document.querySelector(".animate__tools-list")).width;e<t/4&&(t-=e);var n=elementSize(document.querySelector(".animate__tools-colors")).width;n<t/4&&(t-=n);var a=document.querySelector(".animate__canvas");return t-parseInt(getComputedStyle(a).marginLeft)-parseInt(getComputedStyle(a).marginRight)},resizeCanvas:function(){var t=fileData.data.dimensions,e=dimensions[t].size,n=painting.canvas,a=Math.min(painting.availableCanvasWidth(),e[0]),o=e[1]*(a/e[0]),i=a/e[0];document.querySelector(".animate__canvas").style.maxWidth=a+"px",n.setDimensions({width:a,height:o}),n.setZoom(i),n.renderAll(),n.calcOffset()},setCanvasSize:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"square";null===t&&(t=fileData.data.dimensions),t||(t="square"),debugComment("painting: set canvas dimensions."),fileData.setData({dimensions:t}),painting.resizeCanvas()},changeColorEvent:function(t){var e=fileData.data.activeColor,n=fileData.data.palette[e];painting.setColor(n);var a=fileData.data.activeFill,o=fileData.data.palette[a];painting.setFill(o)},changeOpacityEvent:function(t){painting.setOpacity(t.detail.pickOpacity)},objectAddedEvent:function(t){if("select"!==ninjaData.data.activeToolTab){t.target.set({selectable:!1,evented:!1})}},updateBackgroundEvent:function(){painting.drawBackground()},drawBackground:function(){document.documentElement.style.setProperty("--frame-background",this.getCSSBackground())},drawCanvasBackground:function(t){var e=fileData.data,n=painting.canvas.width,a=painting.canvas.height;"transparent"===e.background.type&&(t.fillStyle=exportGif.trans_html,t.fillRect(0,0,n,a)),"background-color"===e.background.type&&(t.fillStyle=e.background.data,t.fillRect(0,0,n,a)),"background-image"===e.background.type&&settingsBackground.background&&t.drawImage(settingsBackground.background,0,0)},getCSSBackground:function(){var t=fileData.data.background;return"background-color"===t.type?t.data:"background-image"===t.type?"url(".concat(t.data,")"):"transparent"},setColor:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(e||t!==painting.color)&&(painting.color=t,"EraserBrush"!==painting.brushName&&(this.canvas.freeDrawingBrush.color=t),ninjaEvent("object-coloured"))},setFill:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(e||t!==painting.fillColor)&&(painting.fillColor=t,ninjaEvent("object-coloured"))},setOpacity:function(t){painting.opacity=t,this.canvas.freeDrawingBrush.opacity=t/100},setBrushSize:function(t){t=parseFloat(t),this.brushSize=t,this.canvas.freeDrawingBrush.width=t,painting.setBrushSmoothness(),painting.setBrushDashArray()},setBrush:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=t.split("-"),n=e[0];null!==t&&(painting.brushName=n||"",painting.brushType=e[1]?e[1]:""),this.canvas.freeDrawingBrush=new fabric[painting.brushName](painting.canvas),painting.setColor(painting.color,!0),painting.setBrushSize(painting.brushSize,!0),painting.setBrushSmoothness(),painting.setBrushDashArray()},setBrushDashArray:function(){this.canvas.freeDrawingBrush.strokeDashArray=toolLinePattern.get(painting.brushType,painting.brushSize)},setBrushSmoothness:function(){if(painting.brushSize){if(this.canvas.freeDrawingBrush.decimate){if("EraserBrush"===painting.brushName)return.1;var t=2;"smooth"===painting.brushType&&(t=5);var e=2;e=Math.ceil(Math.sqrt(painting.brushSize))*t,e=Math.max(4,e),e=Math.min(50,e),this.canvas.freeDrawingBrush.decimate=e}}},setSelectable:function(t){var e=painting.canvas;e.discardActiveObject(),e.selection=t,e.forEachObject((function(e){e.set({selectable:t,evented:t})})),e.renderAll()},clickEvent:function(t){if(t.stopImmediatePropagation(),!0===painting.colorPicker)return console.log("painting: disable picker"),colorPicker.pick(t),void colorPicker.disable();"animate-elements"===t.target.id&&toolActions.deselectAll()},createCanvas:function(){var t=document.createElement("canvas");return t.width=painting.canvas.width,t.height=painting.canvas.height,t},width:function(){var t=painting.canvas;return Math.round(t.width*(100/(100*t.viewportTransform[0])))},height:function(){var t=painting.canvas;return Math.round(t.height*(100/(100*t.viewportTransform[3])))}},colorPicker={$canvas:null,ctx:null,init:function(){null===colorPicker.$canvas&&(document.querySelector(".palette-pipette").addEventListener("click",colorPicker.clickEvent),colorPicker.$canvas=document.createElement("canvas"),colorPicker.$canvas.width=painting.canvas.width,colorPicker.$canvas.height=painting.canvas.height,colorPicker.ctx=colorPicker.$canvas.getContext("2d"))},reset:function(){colorPicker.$canvas=null},clickEvent:function(t){painting.colorPicker?colorPicker.disable():colorPicker.enable()},disable:function(){painting.colorPicker=!1,document.body.classList.remove("color-picker-enabled"),ninjaEvent("change-tool-tab",{name:ninjaData.data.activeToolTab})},enable:function(){painting.colorPicker=!0,document.body.classList.add("color-picker-enabled"),painting.canvas.isDrawingMode=!1,painting.setSelectable(!1)},pick:function(t){colorPicker.init();var e=painting.canvas.getPointer(t),n=e.x,a=e.y;if(n<0||a<0)return!1;if(n>painting.canvas.width||a>painting.canvas.height)return!1;var o=frame.getCurrentFrame();painting.drawCanvasBackground(colorPicker.ctx),colorPicker.ctx.drawImage(frame.getImage(o.id),0,0);var i=colorPicker.ctx.getImageData(n,a,1,1).data;if(0==i[0]&&0==i[1]&&0==i[2]&&0==i[3])return debugComment("picked color is transparent"),!1;var r=colorMath.rgbToHex(i);return debugComment("picked color",r),ninjaEvent("select-color-picker-color",{name:ninjaData.getData().activeToolTab,type:"color-palette",color:r}),r}},toolBrushes={tempBrush:null,position:{left:100,top:100},initialized:!1,init:function(){document.addEventListener("change-tool-tab",toolBrushes.changeToolTabEvent),document.addEventListener("change-tool-type",toolBrushes.changeToolTypeEvent),document.addEventListener("change-tool",toolBrushes.changeToolEvent)},changeToolTabEvent:function(t){painting.canvas.isDrawingMode=!1,"brushes"===t.detail.name?(toolBrushes.load(),painting.canvas.isDrawingMode=!0):toolBrushes.unload()},load:function(){toolBrushes.initialized||(toolBrushes.initialized=!0,painting.canvas.on("mouse:move",toolBrushes.mouseMove),painting.canvas.on("mouse:out",toolBrushes.removeTempBrush),painting.canvas.on("mouse:over",toolBrushes.addTempBrush),painting.canvas.on("path:created",toolBrushes.objectAddedEvent),document.addEventListener("change-color",toolBrushes.changeColorEvent),document.addEventListener("undo-start",toolBrushes.removeTempBrush),document.addEventListener("undo-complete",toolBrushes.addTempBrush),document.addEventListener("save-start",toolBrushes.removeTempBrush),document.addEventListener("save-processed",toolBrushes.addTempBrush),document.addEventListener("update-image-start",toolBrushes.removeTempBrush),document.addEventListener("update-image-complete",toolBrushes.addTempBrush),document.addEventListener("set-frame-start",toolBrushes.removeTempBrush),document.addEventListener("set-frame-complete",toolBrushes.addTempBrush),toolBrushes.addTempBrush())},unload:function(){toolBrushes.initialized=!1,painting.canvas.off("mouse:move",toolBrushes.mouseMove),painting.canvas.off("mouse:out",toolBrushes.removeTempBrush),painting.canvas.off("mouse:over",toolBrushes.addTempBrush),painting.canvas.off("path:created",toolBrushes.objectAddedEvent),document.removeEventListener("change-color",toolBrushes.changeColorEvent),document.removeEventListener("undo-start",toolBrushes.removeTempBrush),document.removeEventListener("undo-complete",toolBrushes.addTempBrush),document.removeEventListener("save-start",toolBrushes.removeTempBrush),document.removeEventListener("save-processed",toolBrushes.addTempBrush),document.removeEventListener("update-image-start",toolBrushes.removeTempBrush),document.removeEventListener("update-image-complete",toolBrushes.addTempBrush),document.removeEventListener("set-frame-start",toolBrushes.removeTempBrush),document.removeEventListener("set-frame-complete",toolBrushes.addTempBrush),toolBrushes.removeTempBrush()},addTempBrush:function(){toolBrushes.removeTempBrush(),painting.brushSize<=8||(toolBrushes.tempBrush=new fabric.Circle({radius:painting.brushSize/2,left:100,top:100,originX:"center",originY:"center",fill:painting.color}),Number.isFinite(toolBrushes.position.top)&&toolBrushes.tempBrush.set({top:toolBrushes.position.top}),Number.isFinite(toolBrushes.position.left)&&toolBrushes.tempBrush.set({left:toolBrushes.position.left}),painting.canvas.add(toolBrushes.tempBrush),painting.canvas.renderAll())},removeTempBrush:function(){toolBrushes.tempBrush&&(toolBrushes.position={left:toolBrushes.tempBrush.left,top:toolBrushes.tempBrush.top},painting.canvas.remove(toolBrushes.tempBrush),toolBrushes.tempBrush=null,painting.canvas.renderAll())},changeToolEvent:function(t){"brushes"===t.detail.name&&(toolBrushes.tempBrush&&(toolBrushes.tempBrush.set({radius:parseFloat(t.detail.value)/2}),painting.canvas.renderAll()),painting.setBrushSize(t.detail.value))},changeToolTypeEvent:function(t){"brushes"===t.detail.name&&painting.setBrush(t.detail.value)},mouseMove:function(t){if(toolBrushes.tempBrush&&!painting.colorPicker){var e=painting.canvas.getPointer(t.e);toolBrushes.tempBrush.set({left:e.x,top:e.y}),painting.canvas.renderAll()}},objectAddedEvent:function(t){painting.fillColor&&"transparent"!==painting.fillColor&&"EraserBrush"!==painting.brushName&&t.path!==toolBrushes.tempBrush&&(t.path.fill=painting.fillColor)},changeColorEvent:function(t){"brushes"===t.detail.name&&"color-palette"===t.detail.type&&toolBrushes.tempBrush&&(toolBrushes.tempBrush.set({fill:painting.color}),painting.canvas.renderAll())}},toolLines={isDown:!1,line:null,origX:0,origY:0,width:settingsBrushSizes.standard.value,borderDashPattern:"",initialized:!1,init:function(){document.addEventListener("change-tool-tab",toolLines.changeToolTabEvent),document.addEventListener("change-tool-type",toolLines.changeToolTypeEvent),document.addEventListener("change-tool",toolLines.changeToolEvent)},changeToolTabEvent:function(t){"lines"===t.detail.name?toolLines.load():toolLines.unload()},load:function(){toolLines.initialized||(toolLines.initialized=!0,painting.canvas.on("mouse:down",toolLines.mouseDown),painting.canvas.on("mouse:up",toolLines.mouseUp),painting.canvas.on("mouse:move",toolLines.mouseMove))},unload:function(){toolLines.initialized=!1,painting.canvas.off("mouse:down",toolLines.mouseDown),painting.canvas.off("mouse:up",toolLines.mouseUp),painting.canvas.off("mouse:move",toolLines.mouseMove)},mouseDown:function(t){this.isDown=!0;var e=painting.canvas.getPointer(t.e);this.origX=toolLines.calcOffset(e.x),this.origY=toolLines.calcOffset(e.y),this.line=new fabric.Line([this.origX,this.origY,this.origX,this.origY],{stroke:painting.color,strokeWidth:toolLines.width,strokeLineCap:"round",strokeDashArray:toolLinePattern.get(toolLines.borderDashPattern,toolLines.width)}),painting.canvas.add(this.line)},mouseMove:function(t){if(this.line&&this.isDown){var e=painting.canvas.getPointer(t.e),n={x2:toolLines.calcOffset(e.x),y2:toolLines.calcOffset(e.y)};this.line.set(n),painting.canvas.renderAll()}},mouseUp:function(){this.line&&this.line.setCoords(),this.isDown=!1,this.line=null,ninjaEvent("object-added")},setSize:function(t){toolLines.width=parseFloat(t)},calcOffset:function(t){return t-toolLines.width/2},changeToolEvent:function(t){"lines"===t.detail.name&&toolLines.setSize(t.detail.value)},changeToolTypeEvent:function(t){"lines"===t.detail.name&&toolLines.setLinePattern(t.detail.value)},setLinePattern:function(t){toolLines.borderDashPattern=t}},toolSelect={initialized:!1,init:function(){document.addEventListener("change-tool-tab",toolSelect.changeToolTabEvent)},load:function(){toolSelect.initialized||(toolSelect.initialized=!0,painting.setSelectable(!0),document.addEventListener("change-tool",toolSelect.changeToolEvent),document.addEventListener("change-color",toolSelect.changeColorEvent))},unload:function(){toolSelect.initialized=!1,painting.setSelectable(!1),document.removeEventListener("change-tool",toolSelect.changeToolEvent),document.removeEventListener("change-color",toolSelect.changeColorEvent)},changeToolTabEvent:function(t){"select"!==t.detail.name?toolSelect.unload():toolSelect.load()},changeColorEvent:function(t){if("select"===t.detail.name&&"color-palette"===t.detail.type){var e=painting.canvas.getActiveObjects();if(!(e.length<=0)){var n=fileData.data.palette[fileData.data.activeColor],a=fileData.data.palette[fileData.data.activeFill];e.forEach((function(t){toolSelect.changeItemColor(t,n,a)})),painting.canvas.renderAll(),ninjaEvent("object-coloured")}}},changeOpacityEvent:function(t){var e=painting.canvas.getActiveObjects();if(!(e.length<=0)){var n=t.detail.pickOpacity;e.forEach((function(t){toolSelect.changeItemOpacity(t,n)})),painting.canvas.renderAll()}},changeItemOpacity:function(t,e){},changeToolEvent:function(t){"select"===t.detail.name&&"function"==typeof toolActions[t.detail.key]&&toolActions[t.detail.key]()},changeItemColor:function(t,e,n){var a={},o=null;void 0!==t.type&&(o=t.type),"group"===o&&toolSelect.changeGroupColor(t.getObjects(),e,n),"line"===fileData.data.pickType&&(a.stroke=e),"fill"===fileData.data.pickType&&(a.fill=n),{}!==a&&t.set(a)},changeGroupColor:function(t,e,n){Object.keys(t).forEach((function(a){toolSelect.changeItemColor(t[a],e,n)}))}},toolShapes={isDown:!1,shape:null,newShape:"square",width:settingsBrushSizes.standard.value,origX:0,origY:0,toolHelper:null,defaultScale:200,defaultSize:10,initialized:!1,init:function(){document.addEventListener("change-tool-tab",toolShapes.changeToolTabEvent),document.addEventListener("change-tool-type",toolShapes.changeToolTypeEvent),document.addEventListener("change-tool",toolShapes.changeToolEvent)},changeToolTabEvent:function(t){"shapes"===t.detail.name?toolShapes.load():toolShapes.unload()},load:function(){toolShapes.initialized||(toolShapes.initialized=!0,painting.canvas.on("mouse:down",toolShapes.mouseDown),painting.canvas.on("mouse:up",toolShapes.mouseUp),painting.canvas.on("mouse:move",toolShapes.mouseMove))},unload:function(){toolShapes.initialized=!1,painting.canvas.off("mouse:down",toolShapes.mouseDown),painting.canvas.off("mouse:up",toolShapes.mouseUp),painting.canvas.off("mouse:move",toolShapes.mouseMove)},mouseDown:function(t){this.isDown=!0;var e=painting.canvas.getPointer(t.e),n=parseInt(toolShapes.width);this.origX=e.x,this.origY=e.y,this.toolHelper=toolShapesSVG,this.shape=this.toolHelper.create(toolShapes.newShape),this.shape?(this.shape.set({left:this.origX,top:this.origY,width:toolShapes.defaultScale,height:toolShapes.defaultScale,fill:painting.fillColor,stroke:painting.color,strokeWidth:n,strokeLineCap:"round",strokeLineJoin:"round"}),console.log("shape start",this.shape),painting.canvas.add(this.shape)):this.shape=null},mouseMove:function(t){if(this.isDown&&this.shape){var e=painting.canvas.getPointer(t.e),n=this.toolHelper.move(e,this.origX,this.origY);this.shape.set(n),painting.canvas.renderAll()}},mouseUp:function(){if(!this.shape)return this.isDown=!1,void(this.shape=null);this.shape.setCoords();var t=this.shape.width*this.shape.scaleX,e=this.shape.height*this.shape.scaleY;t<=toolShapes.defaultSize/2&&e<=toolShapes.defaultSize/2&&painting.canvas.remove(this.shape),t===toolShapes.defaultSize&&e===toolShapes.defaultSize&&painting.canvas.remove(this.shape),console.log("shape end",this.shape),this.isDown=!1,this.shape=null,ninjaEvent("object-added")},changeToolEvent:function(t){"shapes"===t.detail.name&&(toolShapes.width=parseFloat(t.detail.value))},changeToolTypeEvent:function(t){if("shapes"===t.detail.name){var e=t.detail.value;"more"!==e?toolShapes.newShape=e:toolShapesMore.show()}}},toolShapesMore={intialized:!1,shapesList:"#more-shapes-list",init:function(){if(!this.initialized){var t=document.querySelector(this.shapesList);t.addEventListener("click",toolShapesMore.click),t.addEventListener("touchstart",toolShapesMore.click),t.addEventListener("change",toolShapesMore.change)}},show:function(){modal.show("#modal-shapes-more"),this.init(),this.addShapes()},addShapes:function(){var t="";t+=toolShapesMore.shapeFilterDropdown(),Object.keys(SVGShapes).forEach((function(e){var n=SVGShapes[e];t+='\n\t\t\t\t\t<button\n\t\t\t\t\t\tid="shapeButton-'.concat(e,'"\n\t\t\t\t\t\tdata-shape="').concat(e,'"\n\t\t\t\t\t\tdata-category="').concat(n.category,'"\n\t\t\t\t\t\ttitle="Draw ').concat(n.name,'"\n\t\t\t\t\t\tclass="category-').concat(n.category,'"\n\t\t\t\t\t>\n\t\t\t\t\t\t<img src="/assets/stickers/min/').concat(e,'.svg" alt="').concat(n.name,'" />\n\t\t\t\t\t\t<span class="credit">').concat(n.name,"</span>\n\t\t\t\t\t</button>\n\t\t\t\t")})),document.querySelector(this.shapesList).innerHTML=t},shapeFilterDropdown:function(){var t="";return t+='<form><select id="shapeSelect">',Object.keys(SVGShapesCategories).forEach((function(e){var n=SVGShapesCategories[e];t+='<option value="'.concat(e,'">').concat(n,"</option>")})),t+="</select></form>"},change:function(t){var e=t.target;if(0===e.id.lastIndexOf("shapeSelect",0)){var n=e.value,a=document.querySelectorAll("#more-shapes-list button");"all"!==n?a.forEach((function(t){t.getAttribute("data-category").search(n)>=0?t.style.display="block":t.style.display="none"})):a.forEach((function(t){t.style.display="block"}))}},click:function(t){var e=t.target;if(0===e.id.lastIndexOf("shapeButton",0)){var n=e.getAttribute("data-shape");_objectSpread({},ninjaData.getData().activeTools).shapes=n,ninjaEvent("change-tool-type",{name:"shapes",key:n,value:n,type:"property"}),modal.reset()}}},pushAds={nextDisplay:0,displayFrequency:5e3,currentAd:-1,getAd:function(){var t=(new Date).getTime();return t>pushAds.nextDisplay&&(pushAds.nextDisplay=t+pushAds.displayFrequency,pushAds.currentAd=Math.floor(Math.random()*push_ads.length)),this.template(push_ads[pushAds.currentAd])},template:function(t){var e="";t.image&&(e='style="background-image:url(/assets/images/push/'.concat(t.image,');"'));var n=t.description.replace("<a",'<a target="_blank" rel="noreferrer noopener" data-action="allow-click"');return'\n\t\t\t<div class="push" '.concat(e,">\n\t\t\t\t<h3>").concat(t.title,"</h3>\n\t\t\t\t<p>").concat(n,"</p>\n\t\t\t</div>\n\t\t")}},toolLinePattern={get:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=null;if(!t)return n;if(!settingsLinePatterns[t]||void 0===settingsLinePatterns[t])return n;var a=Math.ceil(.75*e);return[settingsLinePatterns[t][0]*Math.max(1,e),settingsLinePatterns[t][1]*Math.max(2,a)]}},toolShapesSVG={create:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(""===t)return!1;var e=toolShapesSVG.getShape(t);return!!e&&(e.set({originX:"center",originY:"top",strokeUniform:!0}),e.setCoords(),e)},move:function(t,e,n){var a={scaleX:Math.abs(e-t.x)/(toolShapes.defaultScale/2),scaleY:Math.abs(n-t.y)/toolShapes.defaultScale,angle:0};return t.y<n&&(a.angle=180),a},getShape:function(t){if(!SVGShapesPaths[t])return!1;var e=new fabric.Path(SVGShapesPaths[t]);return e.scale(toolShapes.defaultSize/toolShapes.defaultScale),e}},wrapText={ALIGN_TOP:1,ALIGN_BOTTOM:2,prepare:function(t,e,n){var a,o=[],i="",r=_createForOfIteratorHelper(e.split(" ").entries());try{for(r.s();!(a=r.n()).done;){var s=_slicedToArray(a.value,2),l=s[0],c=s[1],u=i+c+" ";t.measureText(u).width>n&&l>0?(o.push(i),i=c+" "):i=u}}catch(t){r.e(t)}finally{r.f()}return""!==i&&o.push(i),o},display:function(t,e,n,a,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:wrapText.ALIGN_TOP;a+=Math.round(.7*o),wrapText.ALIGN_BOTTOM===i&&(a-=wrapText.height(e,o)),e.forEach((function(e,i){t.fillText(e,n,a),a+=o}))},height:function(t,e){return t.length*e}},toolText={text:"",position:{left:100,top:100},size:24,tempText:null,box_width:0,initialized:!1,init:function(){document.addEventListener("change-tool-tab",toolText.changeToolTabEvent),document.addEventListener("change-tool-type",toolText.changeToolTypeEvent),document.addEventListener("change-tool",toolText.changeToolEvent)},changeToolTabEvent:function(t){"text"===t.detail.name?toolText.load():toolText.unload()},load:function(){toolText.initialized||(toolText.initialized=!0,painting.canvas.on("mouse:down",toolText.mouseDown),painting.canvas.on("mouse:move",toolText.mouseMove),document.addEventListener("change-text",toolText.changeTextEvent),document.addEventListener("change-color",toolText.changeColorEvent),document.addEventListener("undo-start",toolText.removeTempText),document.addEventListener("undo-complete",toolText.addTempText),document.addEventListener("save-start",toolText.removeTempText),document.addEventListener("save-processed",toolText.addTempText),document.addEventListener("update-image-start",toolText.removeTempText),document.addEventListener("update-image-complete",toolText.addTempText),document.addEventListener("set-frame-start",toolText.removeTempText),document.addEventListener("set-frame-complete",toolText.addTempText),toolText.addTempText())},unload:function(){toolText.initialized=!1,painting.canvas.off("mouse:down",toolText.mouseDown),painting.canvas.off("mouse:move",toolText.mouseMove),document.removeEventListener("change-text",toolText.changeTextEvent),document.removeEventListener("change-color",toolText.changeColorEvent),document.removeEventListener("undo-start",toolText.removeTempText),document.removeEventListener("undo-complete",toolText.addTempText),document.removeEventListener("save-start",toolText.removeTempText),document.removeEventListener("save-processed",toolText.addTempText),document.removeEventListener("update-image-start",toolText.removeTempText),document.removeEventListener("update-image-complete",toolText.addTempText),document.removeEventListener("set-frame-start",toolText.removeTempText),document.removeEventListener("set-frame-complete",toolText.addTempText),toolText.removeTempText()},addTempText:function(){toolText.removeTempText(),toolText.tempText=new fabric.Textbox(toolText.text,{left:100,top:100,width:toolText.box_width,fontSize:toolText.size,fontFamily:toolText.fontFamily,fill:painting.color,editable:!1}),painting.canvas.add(toolText.tempText),Number.isFinite(toolText.position.top)&&toolText.tempText.set({top:toolText.position.top}),Number.isFinite(toolText.position.left)&&toolText.tempText.set({left:toolText.position.left}),painting.canvas.renderAll()},removeTempText:function(){toolText.tempText&&(toolText.position={left:toolText.tempText.left,top:toolText.tempText.top},painting.canvas.remove(toolText.tempText),toolText.tempText=null,painting.canvas.renderAll())},mouseDown:function(t){if(toolText.text){var e=painting.canvas.getPointer(t.e),n=new fabric.Textbox(toolText.text,{left:e.x,top:e.y,width:toolText.box_width,fontSize:toolText.size,fontFamily:toolText.fontFamily,fill:painting.color,editable:!0});painting.canvas.add(n),ninjaEvent("object-added")}else textInput.show()},mouseMove:function(t){if(toolText.tempText){var e=painting.canvas.getPointer(t.e);toolText.tempText.set({left:e.x,top:e.y}),painting.canvas.renderAll()}},setSize:function(t){toolText.size=parseFloat(t),toolText.tempText&&(toolText.tempText.set({fontSize:toolText.size}),painting.canvas.renderAll()),toolText.updateWidth()},setFontFamily:function(t){var e=settingsToolType.text[t];e&&(toolText.fontFamily=e,toolText.tempText&&toolText.tempText.set({fontFamily:toolText.fontFamily}),toolText.updateWidth())},changeToolEvent:function(t){"text"===t.detail.name&&("property"===t.detail.type?toolText.setSize(t.detail.value):textInput.show())},changeColorEvent:function(t){"text"===t.detail.name&&"color-palette"===t.detail.type&&toolText.tempText&&(toolText.tempText.set({fill:painting.color}),painting.canvas.renderAll())},changeToolTypeEvent:function(t){"text"===t.detail.name&&toolText.setFontFamily(t.detail.value)},changeTextEvent:function(t){toolText.text=t.detail.text,toolText.updateWidth(),toolText.tempText&&toolText.tempText.set({text:t.detail.text})},updateWidth:function(){var t=toolText.text.split("\n"),e=0;t.forEach((function(t){e=Math.max(e,t.length)})),toolText.box_width=e*toolText.size*.6,toolText.box_width=Math.min(.8*painting.canvas.width,toolText.box_width),toolText.box_width=Math.floor(toolText.box_width),toolText.tempText&&toolText.tempText.set({width:toolText.box_width})}},toolActions={_clipboard:null,duplicate:function(){var t=painting.canvas,e=t.getActiveObjects(),n=[];if(e){e.forEach((function(e){t.discardActiveObject(),e.clone((function(a){t.add(a.set({left:e.left+15,top:e.top+15,evented:!0})),a.setCoords(),n.push(a)}))}));var a=n[0];n.length>1&&(a=new fabric.ActiveSelection(n,{canvas:t})),a&&(t.setActiveObject(a),t.requestRenderAll())}},delete:function(){var t=painting.canvas,e=t.getActiveObjects();e&&(e.forEach((function(e){t.remove(e)})),t.discardActiveObject(),t.requestRenderAll())},cut:function(){this.copy(),this.delete()},copy:function(){var t=this,e=painting.canvas.getActiveObject();e&&e.clone((function(e){t._clipboard=e}))},paste:function(){var t=painting.canvas;this._clipboard&&(this._clipboard.clone((function(e){t.discardActiveObject(),e.set({evented:!0}),"activeSelection"===e.type?(e.canvas=t,e.forEachObject((function(e){t.add(e)})),e.setCoords()):t.add(e),t.setActiveObject(e),t.requestRenderAll()})),frame.maybeUpdateImageEvent(),t.requestRenderAll())},group:function(){var t=painting.canvas;t.getActiveObject()&&"activeSelection"===t.getActiveObject().type&&(t.getActiveObject().toGroup(),t.requestRenderAll())},ungroup:function(){var t=painting.canvas;t.getActiveObject()&&"group"===t.getActiveObject().type&&(t.getActiveObject().toActiveSelection(),t.requestRenderAll())},bringForward:function(){var t=painting.canvas;t.getActiveObject()&&(t.bringForward(t.getActiveObject()),frame.maybeUpdateImageEvent())},sendBackward:function(){var t=painting.canvas;t.getActiveObject()&&(t.sendBackwards(t.getActiveObject()),frame.maybeUpdateImageEvent())},selectAll:function(){var t=painting.canvas;t.discardActiveObject();var e=new fabric.ActiveSelection(t.getObjects(),{canvas:t});t.setActiveObject(e),t.requestRenderAll()},deselectAll:function(){var t=painting.canvas;t.discardActiveObject(),t.renderAll(),ninjaEvent("selection-cleared")},select:function(t){var e=painting.canvas;e.discardActiveObject(),e.setActiveObject(t),e.requestRenderAll()},deleteAll:function(){var t=painting.canvas;t.remove.apply(t,_toConsumableArray(t.getObjects())),frame.maybeUpdateImageEvent(),this.deselectAll()},layers:function(){_layers.show()},nudge:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=painting.canvas,a=n.getActiveObject();if(a){var o={};null!==t&&(o.left=a.left+t),null!==e&&(o.top=a.top+e),o&&(a.set(o),a.setCoords()),frame.maybeUpdateImageEvent(),n.requestRenderAll()}},flipH:function(){var t=painting.canvas,e=t.getActiveObjects();e&&(e.forEach((function(t){t.flipX=!t.flipX})),t.requestRenderAll())},flipV:function(){var t=painting.canvas.getActiveObjects();t&&(t.forEach((function(t){t.flipY=!t.flipY})),painting.canvas.requestRenderAll())}},backgroundImageUploader={app:void 0,allowedType:["image/png","image/jpg","image/jpeg"],init:function(){var t=document.querySelector("#background-image-upload");backgroundImageUploader.app=new Reef(t,{data:{mode:"upload",timestamp:0},template:backgroundImageUploader.template}),backgroundImageUploader.app.render(),t.addEventListener("click",backgroundImageUploader.click),["dragenter","dragover","dragleave","drop"].forEach((function(e){t.addEventListener(e,(function(t){t.preventDefault(),t.stopPropagation()}),!1)})),t.addEventListener("change",backgroundImageUploader.uploadFileEvent),t.addEventListener("drop",backgroundImageUploader.uploadFileEvent)},template:function(t){return"upload"===t.mode?backgroundImageUploader.getUploadForm():"preview"===t.mode?backgroundImageUploader.preview():""},getUploadForm:function(){return'\n\t\t\t<label for="backgroundImageLoader" class="file-upload">Choose an Image File (png or jpg)\n\t\t\t\t<input\n\t\t\t\t\ttype="file"\n\t\t\t\t\tid="backgroundImageLoader"\n\t\t\t\t\taccept="'.concat(backgroundImageUploader.allowedType.join(", "),'" />\n\t\t\t</label>\n\n\t\t\t<p>Images will be scaled and cropped to <em>').concat(painting.width()," x ").concat(painting.height(),"</em>.</p>\n\t\t")},preview:function(){return'\n\t\t\t<canvas width="'.concat(painting.canvas.width,'" height="').concat(painting.canvas.height,'" id="backgroundImageCanvas"></canvas>\n\t\t\t<button class="button greedy" id="backgroundUploadImageUse">Set as Background</button>\n\t\t\t<button class="button greedy ghost" id="backgroundUploadImageDifferent">&lsaquo; Try another image</button>\n\t\t')},click:function(t){var e=t.target.id;if("backgroundUploadImageDifferent"===e)return debugComment("background-image-uploader: Change to upload mode"),void backgroundImageUploader.app.setData({mode:"upload"});if("backgroundUploadImageUse"===e){var n=document.querySelector("#backgroundImageCanvas").toDataURL("image/jpeg",.85);return debugComment("background-image-uploader: set the background"),fileData.setData({background:{type:"background-image",data:n}}),ninjaEvent("update-background"),void modal.reset()}},uploadFileEvent:function(t){var e=t.target;if("backgroundImageLoader"===e.id){var n=e.files[0]||t.dataTransfer.files[0];n&&backgroundImageUploader.upload(n)}},upload:function(t){if(backgroundImageUploader.allowedType.includes(t.type)){debugComment("background-image-uploader: change to preview mode"),backgroundImageUploader.app.setData({mode:"preview"});var e=new FileReader;e.onload=function(t){var e=new Image;e.onload=function(){var t=painting.canvas,n=t.width,a=t.height,o=document.querySelector("#backgroundImageCanvas").getContext("2d"),i=1;i=e.height>e.width?n/e.width:a/e.height,o.drawImage(e,n/2-e.width*i/2,a/2-e.height*i/2,e.width*i,e.height*i),e.onload=null,e=null},e.src=t.target.result},e.readAsDataURL(t)}}},backgroundImageWebcam={scriptPath:"/assets/build/webcam-easy.min.js",app:void 0,$video:null,webcam:null,init:function(){var t=document.querySelector("#background-image-webcam");backgroundImageWebcam.app=new Reef(t,{data:{mode:"capture",image:{},orientation:"normal"},template:backgroundImageWebcam.template}),backgroundImageWebcam.app.render(),t.addEventListener("click",backgroundImageWebcam.click),document.addEventListener("modal-back",backgroundImageWebcam.disable),document.addEventListener("modal-reset",backgroundImageWebcam.disable),requireJS.load(backgroundImageWebcam.scriptPath,backgroundImageWebcam.initCamera)},initCamera:function(){backgroundImageWebcam.$video=document.getElementById("background-wc-video"),backgroundImageWebcam.webcam=new Webcam(backgroundImageWebcam.$video,"user",painting.width(),painting.height()),backgroundImageWebcam.webcam.setMediaConstraints={audio:!1,video:{width:painting.width(),height:painting.height()}},backgroundImageWebcam.webcam.start().then((function(t){})).catch((function(t){}))},template:function(t){if("preview"===t.mode)return'\n\t\t\t\t<img class="camera-image animation-camera-flash" src="'.concat(t.image[t.orientation],'" alt="Webcam Image Preview" />\n\t\t\t\t<button id="background-wc-usePhoto" class="button greedy">Set as Background</button>\n\t\t\t\t<button id="background-wc-flipPhoto" class="button greedy">Flip Photo</button>\n\t\t\t\t<button id="background-wc-tryAgain" class="button greedy ghost">&lsaquo; Try Again</button>\n\t\t\t');var e="";return e+='\n\t\t\t<video id="background-wc-video" playsinline autoplay width="'.concat(painting.width(),'" height="').concat(painting.height(),'" ></video>\n\t\t\t<button id="background-wc-takePhoto" class="button greedy">Capture</button>\n\t\t')},click:function(t){var e=t.target.id;if("background-wc-flipCamera"===e)return backgroundImageWebcam.webcam.flip(),void backgroundImageWebcam.webcam.start();if("background-wc-takePhoto"===e){var n=backgroundImageWebcam.webcam.snap();return debugComment("background-image-webcam: preview webcam image"),backgroundImageWebcam.app.setData({image:n,mode:"preview",orientation:"normal"}),void backgroundImageWebcam.disable()}if("background-wc-tryAgain"===e)return debugComment("background-image-webcam: try taking another image"),backgroundImageWebcam.app.setData({image:null,mode:"capture",orientation:"normal"}),backgroundImageWebcam.app.render(),void backgroundImageWebcam.initCamera();if("background-wc-flipPhoto"===e){var a="normal";return"normal"===backgroundImageWebcam.app.data.orientation&&(a="flipped"),debugComment("background-image-webcam: flip photo"),void backgroundImageWebcam.app.setData({orientation:a})}if("background-wc-usePhoto"===e){debugComment("background-image-webcam: set the background.");var o=backgroundImageWebcam.app.data,i=o.image,r=o.orientation;return fileData.setData({background:{type:"background-image",data:i[r]}}),ninjaEvent("update-background"),void modal.reset()}},disable:function(){backgroundImageWebcam.webcam&&(backgroundImageWebcam.webcam.stop(),backgroundImageWebcam.webcam=null)}},unsplashImageList={app:void 0,init:function(){if(void 0===this.app){var t=document.querySelector(".unsplash-search-results");unsplashImageList.app=new Reef(t,{data:{mode:"idle",data:[],image:{}},template:unsplashImageList.template}),unsplashImageList.app.render(),t.addEventListener("click",unsplashImageList.click)}},template:function(t){return"idle"!==t.mode&&t.mode?"list"===t.mode&&t.data.length>0?unsplashImageList.listImages(t):"list"===t.mode&&t.data.length<=0?'\n\t\t\t\t<div class="error show">\n\t\t\t\t\t<h3>Nothing Found</h3>\n\t\t\t\t\t<p>Sorry. Please try a different search term.</p>\n\t\t\t\t</div>\n\t\t\t':"preview"===t.mode?unsplashImageList.preview(t):"loading"===t.mode?'<div class="loading">Searching...</div>':(t.mode,""):""},preview:function(t){var e=t.image,n=painting.canvas,a=n.width,o=n.height;return'\n\t\t\t<div class="preview-image">\n\t\t\t\t<img\n\t\t\t\t\tsrc="'.concat(e.url,"&w=").concat(a,"&h=").concat(o,'&fit=crop"\n\t\t\t\t\talt="').concat(e.alt,'"\n\t\t\t\t\twidth="').concat(a,'"\n\t\t\t\t\theight="').concat(o,'"\n\t\t\t\t\tcrossOrigin="anonymous"\n\t\t\t\t\tid="unsplashPreviewImage"\n\t\t\t\t/>\n\t\t\t\t<p class="credit">Photo by <a href="').concat(e.author_url,'" target="_blank">').concat(e.author,'</a> on <a href="https://unsplash.com/').concat(unsplash.utm_credits,'" target="_blank">Unsplash</a>.</p>\n\t\t\t</div>\n\t\t\t<button class="button greedy" id="unsplashUseImage" data-id="').concat(e.id,'">Set as background</button>\n\t\t\t<button class="button greedy ghost" id="unsplashResults">&larr; Try another image</button>\n\t\t')},listImages:function(t){var e="";return Object.keys(t.data).forEach((function(n){var a=t.data[n],o=unsplashImageList.imageUrl(a.urls.raw+"&w=300&h=300&fit=crop"),i=a.user.links.html+unsplash.utm_credits,r=a.user.name;e+='\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass="thumbnail thumbnail-fullwidth-image"\n\t\t\t\t\t\tid="unsplashImage-'.concat(a.id,'"\n\t\t\t\t\t\tdata-id="').concat(a.id,'"\n\t\t\t\t\t\tdata-raw="').concat(a.urls.raw,'"\n\t\t\t\t\t\tdata-author="').concat(r,'"\n\t\t\t\t\t\tdata-author-url="').concat(i,'"\n\t\t\t\t\t\tdata-alt="').concat(a.alt_description,'"\n\t\t\t\t\t>\n\t\t\t\t\t\t<img src="').concat(o,'" width="200" height="200" alt="').concat(a.alt_description,'" />\n\t\t\t\t\t\t<a href="').concat(i,'" target="_blank" class="credit">').concat(r,"</a>\n\t\t\t\t\t</button>\n\t\t\t\t")})),'<div class="unsplash-image-list button-grid">'+e+"</div>"},imageUrl:function(t){return t=t.replace("&amp;crop=entropy",""),t=encodeURI(t)},click:function(t){var e=t.target,n=e.id;if(0===n.lastIndexOf("unsplashImage",0))return debugComment("background-image-unsplash: preview an image"),void unsplashImageList.app.setData({mode:"preview",image:{url:e.getAttribute("data-raw"),author:e.getAttribute("data-author"),author_url:e.getAttribute("data-author-url"),id:e.getAttribute("data-id"),alt:e.getAttribute("data-alt")}});if(0===n.lastIndexOf("unsplashResults",0))return debugComment("background-image-unsplash: change the list mode"),void unsplashImageList.app.setData({mode:"list"});if(0===n.lastIndexOf("unsplashUseImage",0)){var a=document.querySelector("#unsplashPreviewImage").getAttribute("src"),o=e.getAttribute("data-id");return unsplash.download(o),unsplashImageList.toDataURL(a),void modal.reset()}},toDataURL:function(t){var e=new Image;e.setAttribute("crossOrigin","anonymous"),e.onload=function(){var t=document.createElement("canvas");t.width=painting.canvas.width,t.height=painting.canvas.height,t.getContext("2d").drawImage(this,0,0);var e=t.toDataURL("image/jpeg",.85);debugComment("background-image-unsplash: Set the background."),fileData.setData({background:{type:"background-image",data:e}}),ninjaEvent("update-background"),t.remove(),this.remove()},e.src=t}},settings={app:void 0,initiliazed:!1,creditsOverlay:null,init:function(){if(!settings.initialized){settings.initialized=!0;var t=document.querySelector("#modal-settings form");settings.app=new Reef(t,{data:fileData.data,template:settings.template,attachTo:[fileData]}),settings.creditsOverlay=document.querySelector(".credits-overlay"),fileData.render(),t.addEventListener("click",settings.click)}},template:function(t){return settings.updateCreditsText(t.credits),'\n\t\t\t<label for="animation-credits">Credits</label>\n\t\t\t<input id="animation-credits" name="animation-credits" type="text" value="'.concat(sanitize.attr(t.credits),'">\n\t\t\t<input type="submit" class="button" id="save-file-settings" value="Save Settings">\n\t\t')},show:function(){settings.init(),modal.show("#modal-settings")},updateCreditsText:function(t){var e=settings.creditsOverlay,n=e.getContext("2d"),a=painting.width(),o=painting.height(),i=a-15,r=o-18;settings.creditsOverlay.width=a,settings.creditsOverlay.height=o,n.clearRect(0,0,e.width,e.height),n.font="bold 14px Arial",n.fillStyle="white",n.shadowColor="black",n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=3,n.textAlign="right",n.fillText(t,i,r)},click:function(t){if("save-file-settings"===t.target.id){t.preventDefault(),t.stopPropagation();var e=document.querySelector("#animation-credits").value;return debugComment("settings: Update the credits text."),fileData.setData({credits:e}),void modal.reset()}}},textInput={app:void 0,init:function(){var t=document.querySelector("form#text-input");textInput.app=new Reef(t,{data:{text:""},template:textInput.template,allowHTML:!0}),textInput.app.render(),t.addEventListener("click",textInput.click)},template:function(t){return'<label>Your Text</label>\n\t\t<textarea type="text" id="text-content" style="min-height:10rem;">'.concat(sanitize.html(t.text),"</textarea>\n\t\t").concat(textInput.emojiList(),'\n\t\t<button\n\t\t\tclass="button"\n\t\t\tid="useText"\n\t\t\ttitle="Use this text"\n\t\t>Use</button>')},emojiList:function(){var t="";return emoji_icons.forEach((function(e,n){t+='<button\n\t\t\t\t\tid="useEmoji'.concat(n,'"\n\t\t\t\t\tdata-emoji="').concat(e,'"\n\t\t\t\t\ttype="button"\n\t\t\t\t\tclass="button teeny ghost">').concat(e,"</button>")})),'<div class="text-content-emojis">'.concat(t,"</div>")},click:function(t){var e=t.target.id;if(0===e.lastIndexOf("useEmoji",0))return t.preventDefault(),t.stopPropagation(),void typeInTextarea(t.target.getAttribute("data-emoji"),document.querySelector("form#text-input #text-content"));if("useText"===e){t.preventDefault(),t.stopPropagation();var n=document.querySelector("#text-content");debugComment("text-input: set the text data."),textInput.app.setData({text:n.value}),ninjaEvent("change-text",{text:n.value}),modal.reset()}},show:function(){modal.show("#modal-text-input"),setTimeout((function(){return document.querySelector("#text-content").focus()}),100)}},paletteColorPicker={app:void 0,picker:null,init:function(){var t=document.querySelector(".palette-color-picker");paletteColorPicker.app=new Reef(t,{data:fileData.data,template:paletteColorPicker.template,attachTo:[fileData]}),fileData.render(),this.picker=new customColorPicker(".palette-flexi-picker","color-palette"),t.addEventListener("click",paletteColorPicker.click),document.addEventListener("canvas-init",paletteColorPicker.addEvents),resetAnimation(t,"animation-pulse-small")},addEvents:function(){painting.canvas.on("selection:created",paletteColorPicker.pickColor),painting.canvas.on("selection:updated",paletteColorPicker.pickColor),document.addEventListener("change-color",paletteColorPicker.pickColor)},template:function(t){var e=t.activeColor,n=painting.color;"fill"===t.pickType&&(e=t.activeFill,n=painting.fillColor);var a=t.palette[e],o="",i="";return a!==n&&(i="animation-pulse-small"),document.querySelectorAll(".tools-list").forEach((function(t){t.style.color=painting.color,t.setAttribute("data-color-id",fileData.data.activeColor)})),o+='\n\t\t\t<div class="palette-color-picker__splat-wrapper">\n\t\t\t\t<button\n\t\t\t\t\tclass="palette-color-picker__splat '.concat(i,'"\n\t\t\t\t\tid="color-picker"\n\t\t\t\t\tdata-color="').concat(e,'"\n\t\t\t\t\ttitle="Change the current color"\n\t\t\t\t\taria-hidden="true"\n\t\t\t\t>\n\t\t\t\t\t<span\n\t\t\t\t\t\tstyle="color:').concat(a,';"\n\t\t\t\t\t\tclass="splat"\n\t\t\t\t\t>').concat(SVGIcons["palette-splat"],'</span>\n\t\t\t\t\t<span\n\t\t\t\t\t\tstyle="color:').concat(colorMath.brightness(a)?"black":"white",';"\n\t\t\t\t\t\tclass="icon"\n\t\t\t\t\t>').concat(SVGIcons[t.pickType],'</span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<button\n\t\t\t\tclass="palette-color-picker__change button teeny"\n\t\t\t\tid="color-picker-change"\n\t\t\t\tdata-color="').concat(e,'"\n\t\t\t\ttitle="Change the current color"\n\t\t\t>\n\t\t\t\tChange\n\t\t\t</button>\n\t\t\t<button\n\t\t\t\tclass="palette-pipette m-t2 display-block "\n\t\t\t\ttitle="Select a colour from the image."\n\t\t\t>\n\t\t\t\t').concat(SVGIcons.pipette,'\n\t\t\t\t<span class="screen-reader-text">Pick Color</span>\n\t\t\t</button>')},click:function(t){var e=t.target,n=e.id;if("color-picker"===n||"color-picker-change"===n){modal.show("#modal-color-palette");var a=fileData.data.palette[e.getAttribute("data-color")];paletteColorPicker.picker.setColor(a)}if("color-picker-pipette"===n&&ninjaEvent("select-color-picker-color",{color:fileData.data.pickColor,type:"color-palette"}),"color-picker-opacity"===n){var o=Math.round(fileData.data.pickOpacity)+25;o>100&&(o=25),debugComment("palette-color-picker: Set the opacity."),fileData.setData({pickOpacity:o}),ninjaEvent("change-opacity",{pickOpacity:o})}},pickColor:function(t){var e=painting.canvas.getActiveObjects();if(!(e.length<=0)){var n=e[0],a=null;n&&t.detail&&"color-palette"===t.detail.type?a=fileData.data.palette[fileData.data.activeColor]:(null!==n.stroke&&(a=n.stroke),null===n.stroke&&(a=n.fill)),a&&(debugComment("palette-color-picker: Set the color."),fileData.setData({pickColor:a}))}}},paletteColorType={app:void 0,init:function(){var t=document.querySelector(".palette-color-type");paletteColorType.app=new Reef(t,{data:fileData.data,template:paletteColorType.template,attachTo:[fileData]}),fileData.render(),t.addEventListener("click",paletteColorType.click),document.addEventListener("change-tool-tab",paletteColorType.changeToolTabEvent)},template:function(t){var e=colorMath.brightness(painting.color)?"black":"white",n=colorMath.brightness(painting.fillColor)?"black":"white",a="color-".concat(urlString(painting.color)),o="color-".concat(urlString(painting.fillColor)),i="";painting.color&&"transparent"!==painting.color&&(i="background-color: ".concat(painting.color,";"));var r="";return painting.fillColor&&"transparent"!==painting.fillColor&&(r="background-color: ".concat(painting.fillColor,";")),'\n\t\t\t<button\n\t\t\t\tid="palette-line"\n\t\t\t\tdata-type="line"\n\t\t\t\tclass="'.concat("line"===t.pickType?"selected":""," button ").concat(a,'"\n\t\t\t\ttitle="Set the Line Color"\n\t\t\t\tstyle="').concat(i," color: ").concat(e,';"\n\t\t\t>\n\t\t\t\t').concat(SVGIcons.line,'\n\t\t\t</button>\n\t\t\t<button\n\t\t\t\tid="palette-fill"\n\t\t\t\tdata-type="fill"\n\t\t\t\tclass="').concat("fill"===t.pickType?"selected":""," button ").concat(o,'"\n\t\t\t\ttitle="Set the Fill Color"\n\t\t\t\tstyle="').concat(r," color: ").concat(n,';"\n\t\t\t>\n\t\t\t\t').concat(SVGIcons.fill,"\n\t\t\t</button>\n\t\t")},click:function(t){var e=t.target;0===e.id.lastIndexOf("palette",0)&&(debugComment("palette-color-type: Set the color type (stroke/ fill)."),fileData.setData({pickType:e.getAttribute("data-type")}),ninjaEvent("change-color",{name:"select",type:"color-palette"}))},changeToolTabEvent:function(t){"select"!==t.detail.name&&(debugComment("palette-color-type: Set the pick type to stroke (line)."),fileData.setData({pickType:"line"}))}},playback={app:void 0,frames:[],init:function(){var t=document.querySelector(".playback");playback.app=new Reef(t,{data:playbackData.data,template:playback.template,attachTo:[playbackData]}),playbackData.render()},toggle:function(){var t=playbackData.getData().playing;t||playback.start(),t&&playback.stop()},start:function(){frame.count()<=1||(document.querySelector("body").classList.add("ninja-playing"),playback.frames=frame.getFrames().map((function(t){return{id:t.id,length:t.length}})),debugComment("playback: play animation"),playbackData.setData({playing:!0,frame:0}),playback.nextFrame())},stop:function(){document.querySelector("body").classList.remove("ninja-playing"),debugComment("playback: stop animation"),playbackData.setData({playing:!1})},nextFrame:function(){var t=playbackData.getData();t.playing&&setTimeout(playback.update,playback.interval(playback.frames[t.frame]))},interval:function(t){t&&t.length||(t.length=1);var e=t.length;e&&void 0!==e||(e=1);var n=fileData.data.frameRate;return n&&void 0!==n||(n=fileDataDefault.frameRate),Math.round(1e3/parseFloat(n)*e)},totalTime:function(){var t=fileData.data.frames,e=0;return t.forEach((function(t){e+=playback.interval(t)})),e},update:function(){var t=playbackData.getData().frame+1;t>=playback.frames.length&&(t=0),debugComment("playback: update/ revert animation frame"),playbackData.setData({frame:t}),playback.nextFrame()},template:function(t){if(!t.playing)return"";var e=painting.canvas,n=frame.getImage(playback.frames[t.frame].id);return'\n\t\t<div class="playback__image">\n\t\t\t<img src="'.concat(n.getAttribute("src"),'" height="').concat(e.height,'" width="').concat(e.width,'" />\n\t\t</div>\n\t\t')}},frameRate={app:void 0,maxValue:30,init:function(){var t=document.querySelector("#modal-settings-frame-rate form");frameRate.app=new Reef(t,{data:fileData.data,template:frameRate.template,attachTo:[fileData]}),fileData.render(),t.addEventListener("click",frameRate.click),t.addEventListener("change",frameRate.maybeChangeEvent),t.addEventListener("mousemove",frameRate.maybeChangeEvent)},template:function(t){var e=Math.min(parseFloat(t.frameRate),frameRate.maxValue),n=Math.min(parseFloat(t.frameRateValue),frameRate.maxValue+10),a=Math.ceil(e/12);return'\n\t\t\t<label for="frame-rate">Frame Rate</label>\n\t\t\t<div class="range-input">\n\t\t\t\t<input\n\t\t\t\t\ttype="range"\n\t\t\t\t\tid="frame-rate"\n\t\t\t\t\tname="frame-rate"\n\t\t\t\t\tvalue="'.concat(parseFloat(n),'"\n\t\t\t\t\tmin="1"\n\t\t\t\t\tmax="').concat(parseFloat(frameRate.maxValue+10),'"\n\t\t\t\t>\n\t\t\t\t<span\n\t\t\t\t\tclass="range-input__value"\n\t\t\t\t\tfor="frame-rate"\n\t\t\t\t>').concat(zeroPadNumber(e,2),"</span>\n\t\t\t</div>\n\t\t\t<p>The animation will show <em>").concat(e,"</em> frames per second. Each frame will display for <em>").concat((1/e).toFixed(a),'</em> seconds.</p>\n\t\t\t<button\n\t\t\t\tid="set-frame-rate"\n\t\t\t\tclass="button"\n\t\t\t\ttitle="Finished setting the frame rate"\n\t\t\t>Done</button>\n\t\t')},click:function(t){if("set-frame-rate"===t.target.id)return t.preventDefault(),t.stopPropagation(),void modal.reset()},maybeChangeEvent:function(t){var e=t.target;e&&"frame-rate"===e.id&&(clearTimeout(frameRate.changeTimeout),frameRate.changeTimeout=setTimeout(frameRate.changeEvent,100))},changeEvent:function(t){var e=document.getElementById("frame-rate"),n=parseInt(e.value),a=n;n<=10&&(n/=10),n>10&&(n-=10),debugComment("frame-rate: Set the frame rate."),fileData.setData({frameRate:n,frameRateValue:a}),playbackData.render()},show:function(){modal.show("#modal-settings-frame-rate")}},frameNotes={app:void 0,initialized:!1,init:function(){if(!frameNotes.initialized){frameNotes.initialized=!0;var t=document.querySelector("#frame-notes");frameNotes.app=new Reef(t,{data:fileData.data,template:frameNotes.template,attachTo:[fileData]}),fileData.render(),t.addEventListener("click",frameNotes.click)}},show:function(){frameNotes.init(),fileData.render(),modal.show("#modal-frame-notes")},template:function(t){console.log("update template");var e=" ",n=frame.getCurrentFrame();return"notes"in n&&(e=n.notes),'\n\t\t\t<textarea id="frame-note-text">'.concat(sanitize.html(e),'</textarea>\n\t\t\t<button id="frame-note-save" class="button">Save Caption</button>\n\t\t')},click:function(t){if("frame-note-save"===t.target.id){debugComment("frameNotes: save component data");var e=fileData.data.frames;e[frame.getID(fileData.data.currentFrame)].notes=sanitize.html(document.querySelector("#frame-note-text").value),ninjaData.setData({frames:e}),modal.reset()}}},fileNew={app:void 0,init:function(){if(!fileNew.app){var t=document.querySelector("#file-new-animation");fileNew.app=new Reef(t,{data:{mode:"check"},template:fileNew.template}),fileNew.app.render(),t.addEventListener("click",fileNew.click)}},template:function(t){if("check"===t.mode)return'\n\t\t\t\t<p>Creating a new animation will delete your current animation.\n\t\t\t\t<br /><strong>Do you want to continue?</strong></p>\n\t\t\t\t<button class="button" id="file-new-new">New</button>\n\t\t\t\t<button class="button" id="file-new-save">Save</button>\n\t\t\t';var e="";return Object.keys(dimensions).forEach((function(t){var n=dimensions[t];e+='\n\t\t\t\t\t<div class="button-description">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass="button greedy"\n\t\t\t\t\t\t\tdata-size="'.concat(t,'"\n\t\t\t\t\t\t\taria-describedby="description-new-').concat(t,'"\n\t\t\t\t\t\t\tid="file-new-animation-').concat(t,'"\n\t\t\t\t\t\t>').concat(n.label,'</button>\n\t\t\t\t\t\t<p id="description-new-').concat(t,'">').concat(n.description,"</p>\n\t\t\t\t\t</div>\n\t\t\t\t")})),e},click:function(t){t.preventDefault();var e=t.target,n=e.id;if("file-new-save"===n)return modal.reset(),void saveAnimation.run();if("file-new-new"===n)return debugComment("file-new: select mode"),void fileNew.app.setData({mode:"select"});if(0!==n.lastIndexOf("file-new-animation",0));else{modal.reset();var a=e.getAttribute("data-size");ninjaDataReset(a)}},show:function(){fileNew.init(),debugComment("file-new: check mode"),fileNew.app.setData({mode:"check"}),modal.show("#modal-new-animation")}},fileOpen={app:void 0,init:function(){var t=document.querySelector("#file-open-upload");fileOpen.app=new Reef(t,{data:{mode:"upload"},template:fileOpen.template}),fileOpen.app.render(),["dragenter","dragover","dragleave","drop"].forEach((function(e){t.addEventListener(e,(function(t){t.preventDefault(),t.stopPropagation()}),!1)})),t.addEventListener("change",fileOpen.change),t.addEventListener("drop",fileOpen.dropEvent)},template:function(t){return"upload"===t.mode?'\n\t\t\t\t<label for="fileOpenUploader" class="file-upload">Choose a Brush Ninja File\n\t\t\t\t\t<input type="file" id="fileOpenUploader" accept=".brushninja" />\n\t\t\t\t</label>\n\t\t\t\t<hr />\n\t\t\t\t'.concat(fileOpen.demoTemplate(),"\n\t\t\t"):'\n\t\t\t<div class="loading">Loading</div>\n\t\t'},demoTemplate:function(){var t="";return demoFiles.forEach((function(e){t+='<li><a href="https://brush-ninja.s3.amazonaws.com/sample-files/'.concat(e.file,'.brushninja" download>').concat(e.name,"</a></li>")})),"\n\t\t\t<h2>Example Files</h2>\n\t\t\t<p>Download any (or all) of the files below to see what you can do with Brush Ninja.</p>\n\t\t\t<ul>".concat(t,"</ul>\n\t\t")},change:function(t){var e=t.target;"fileOpenUploader"===e.id&&fileOpen.upload(e.files[0])},dropEvent:function(t){if(t.dataTransfer&&t.dataTransfer.files&&t.target&&t.target.files){var e=t.dataTransfer.files[0]||t.target.files[0];e&&fileOpen.upload(e)}},upload:function(t){if("brushninja"!==t.name.slice(t.name.length-10))return modal.reset(),void alert("Unrecognised File Type");var e=new FileReader;e.onload=function(){var t=fileFormat.load(e.result);debugComment("file-open: Set the data after opening a file."),fileData.setData(t),ninjaDataUpdate(),modal.reset()},e.readAsText(t),debugComment("file-open: loading mode"),fileOpen.app.setData({mode:"loading"})}},controls={app:void 0,init:function(){frameRate.init();var t=document.querySelector(".controls");controls.app=new Reef(t,{data:playbackData.data,template:controls.template,attachTo:[playbackData]}),playbackData.render(),t.addEventListener("click",controls.click)},template:function(t){var e="",n="Play Animation",a="controls-play",o=frame.getPosition(fileData.data.currentFrame),i=frame.count().toString();t.playing&&(n="Stop Animation",a="controls-stop",o=t.frame),o=zeroPadNumber(o+1,i.length);var r=Math.min(fileData.data.frameRate,frameRate.maxValue),s="frame-rate-"+Math.ceil(r/frameRate.maxValue*3);return e+='\n\t\t<div class="controls__panel toolbar bg-secondary">\n\n\t\t\t<button class="controls__actions_speed" title="Set Animation Speed">'.concat(SVGIcons[s],'</button>\n\t\t\t<button class="controls__actions_background" title="Select a Background">').concat(SVGIcons.background,'</button>\n\n\t\t\t<button id="play-button" class="button" title="').concat(n,'">\n\t\t\t\t').concat(SVGIcons[a],'\n\t\t\t\t<span class="screen-reader-text">').concat(n,'</span>\n\t\t\t</button>\n\n\t\t\t<div class="controls__frame">\n\t\t\t\t<span>Frame</span>\n\t\t\t\t').concat(o," of ").concat(i,'\n\t\t\t</div>\n\n\t\t\t<button class="controls__actions_notes" title="Set Frame Caption">').concat(SVGIcons.captions,"</button>\n\n\t\t</div>")},click:function(t){var e=t.target;"play-button"!==e.id?e.classList.contains("controls__actions_speed")?frameRate.show():e.classList.contains("controls__actions_notes")?frameNotes.show():e.classList.contains("controls__actions_background")?settingsBackground.show():e.classList.contains("controls__actions_onion")&&onionSkin.toggle():playback.toggle()}},timeline={app:void 0,sortable:null,init:function(){var t=document.querySelector(".timeline__wrapper");timeline.app=new Reef(t,{data:fileData.data,template:timeline.template,attachTo:[fileData]}),fileData.render(),t.addEventListener("click",timeline.click),t.addEventListener("touchstart",timeline.click),timeline.sortable=Sortable.create(t,{draggable:".drag",onEnd:function(t){frame.move(t.oldIndex,t.newIndex)}})},template:function(t){var e="";return t.frames.forEach((function(n,a){n&&"new-frame"===n.id?e+='\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tid="new-frame"\n\t\t\t\t\t\t\tclass="new-frame drag"\n\t\t\t\t\t\t\ttitle="Add a new frame"\n\t\t\t\t\t\t>Add +</button>':e+=frame.template(n,a,t.currentFrame)})),e},click:function(t){var e=t.target,n=e.id,a=e.className;if("new-frame"===n)return t.stopPropagation(),t.preventDefault(),toolActions.deselectAll(),void frame.add();if(0!==n.lastIndexOf("frame-",0))if(a&&"tool-delete"===a){t.stopPropagation(),t.preventDefault();var o=e.getAttribute("data-index");frame.delete(o)}else if(a&&"tool-duplicate"===a){t.stopPropagation(),t.preventDefault(),toolActions.deselectAll();var i=e.getAttribute("data-index");frame.duplicate(i)}else if(a&&"length-increase"===a){t.stopPropagation(),t.preventDefault();var r=e.getAttribute("data-index");frame.increase(r)}else if(a&&"length-decrease"===a){t.stopPropagation(),t.preventDefault();var s=e.getAttribute("data-index");frame.decrease(s)}else;else{t.stopPropagation(),t.preventDefault(),toolActions.deselectAll();var l=e.getAttribute("data-index");frame.setFrame(l)}}},toolTabs={app:void 0,init:function(){var t=document.querySelector(".tool-tabs");toolTabs.app=new Reef(t,{data:ninjaData.data,template:toolTabs.template,attachTo:[ninjaData]}),toolTabs.app.render(),t.addEventListener("click",toolTabs.click)},template:function(t){var e="";return settingsToolTabs.tools.forEach((function(n){var a="";n.tab===t.activeToolTab&&(a="selected"),e+='\n\t\t\t\t<button\n\t\t\t\t\tid="toolTab-'.concat(n.tab,'"\n\t\t\t\t\tclass="').concat(a,'"\n\t\t\t\t\tdata-name="').concat(n.tab,'"\n\t\t\t\t\ttitle="Use ').concat(n.title,'"\n\t\t\t\t>\n\t\t\t\t\t<img src="/assets/images/tool-tabs/').concat(n.tab,'.svg" alt="').concat(n.title,'" />\n\t\t\t\t</button>')})),e},click:function(t){var e=t.target;0===e.id.lastIndexOf("toolTab",0)&&toolTabs.set(e.getAttribute("data-name"))},set:function(t){painting.canvas.discardActiveObject(),debugComment("tool-tabs: change active tool tab ".concat(t)),ninjaData.setData({activeToolTab:t}),ninjaEvent("change-tool-tab",{name:t})}},toolType={app:void 0,init:function(){var t=document.querySelector(".tool-type");toolType.app=new Reef(t,{data:ninjaData.data,template:toolType.template,attachTo:[ninjaData]}),ninjaData.render(),t.addEventListener("click",toolType.click)},template:function(t){var e="";if(!settingsToolType[t.activeToolTab])return e;var n=t.activeToolType[t.activeToolTab];return Object.keys(settingsToolType[t.activeToolTab]).forEach((function(a){var o=settingsToolType[t.activeToolTab][a],i="toolType-"+a;a===n&&(i+=" selected"),e+='\n\t\t\t\t\t<button\n\t\t\t\t\t\tid="toolType-'.concat(a,'"\n\t\t\t\t\t\tdata-value="').concat(a,'"\n\t\t\t\t\t\tdata-title="').concat(o,'"\n\t\t\t\t\t\tdata-name="').concat(t.activeToolTab,'"\n\t\t\t\t\t\tclass="').concat(i,'"\n\t\t\t\t\t>').concat(o,"</button>")})),e},click:function(t){var e=t.target;if(0===e.id.lastIndexOf("toolType",0)){var n=e.getAttribute("data-value"),a=e.getAttribute("data-name"),o=_objectSpread({},ninjaData.getData().activeToolType);o[a]=n,debugComment("tool-type: Change tool mode ".concat(o,".")),ninjaData.setData({activeToolType:o}),ninjaEvent("change-tool-type",{value:n,name:a})}}},tools={app:void 0,brightness_class:"bg-light",init:function(){var t=document.querySelector(".tools-list");toolTabs.app=new Reef(t,{data:ninjaData.data,template:tools.template,attachTo:[ninjaData]}),toolTabs.app.render(),t.addEventListener("click",tools.click)},template:function(t){var e="";if(!settingsTools[t.activeToolTab]||settingsTools[t.activeToolTab].length>1)return e;var n=settingsTools[t.activeToolTab];return Object.keys(n).forEach((function(a){var o=n[a];if("spacer"===o.type)e+='<hr role="separator" aria-hidden="true" />';else e+=tools.htmlButton(a,o,t)})),e},htmlButton:function(t,e,n){var a=["tools-list__button"],o=e.value;e.type||(e.type="property"),a.push("tools-list__button-".concat(e.type)),e.icon&&a.push("tools-list__button-icon"),t===n.activeTools[n.activeToolTab]&&a.push("selected");var i=e.value;e.icon&&(i=SVGIcons[e.icon]);var r="";return e.title&&(r='title="'.concat(e.title,'"')),'\n\t\t\t<button\n\t\t\t\tdata-key="'.concat(t,'"\n\t\t\t\tdata-value="').concat(o,'"\n\t\t\t\tdata-name="').concat(n.activeToolTab,'"\n\t\t\t\tdata-type="').concat(e.type,'"\n\t\t\t\tclass="').concat(a.join(" "),'"\n\t\t\t\tid="toolsTool-').concat(t,'"\n\t\t\t\t').concat(r,"\n\t\t\t>\n\t\t\t\t").concat(i,"\n\t\t\t</button>")},click:function(t){var e=t.target;if(0===e.id.lastIndexOf("toolsTool",0)){var n=e.getAttribute("data-key"),a=parseFloat(e.getAttribute("data-value")),o=e.getAttribute("data-name"),i=e.getAttribute("data-type"),r=_objectSpread({},ninjaData.getData().activeTools);"property"===i&&(r[ninjaData.getData().activeToolTab]=n,debugComment("tools: Change active tool"),ninjaData.setData({activeTools:r})),ninjaEvent("change-tool",{name:o,key:n,value:a,type:i})}}},customColorPicker=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];_classCallCheck(this,t),this.selector=e,this.color="#ffffff",this.container=null,this.hexInput=null,this.picker=null,this.type=n,this.resetEnabled=a,this.click=this.click.bind(this),this.setup()}return _createClass(t,[{key:"setup",value:function(){var t=this;if(this.selector){var e=document.querySelector(this.selector);e.innerHTML=this.template(),this.container=document.querySelector(this.selector+" .flexi-color-picker-wrapper"),this.hexInput=document.querySelector(this.selector+" .flexi-color-hex"),this.picker=ColorPicker(document.querySelector(this.selector+" .flexi-color-picker"),(function(e){t.setColor(e,!1)})),e.addEventListener("click",this.click),this.hexInput.addEventListener("keyup",(function(e){"Enter"===e.code&&t.updateFromHex(e.target.value)})),this.hexInput.addEventListener("blur",(function(e){t.updateFromHex(e.target.value)}))}}},{key:"setColor",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t||(t="#000"),this.container.style.backgroundColor=t,this.color=t,this.hexInput.value=t.toUpperCase(),e&&(4===t.length&&(t="#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]),this.picker.setHex(t))}},{key:"template",value:function(){var t="",e="";return this.resetEnabled&&(e+='<button class="button teeny action-reset">Reset Palette</button>'),e+='<button class="button teeny action-pick">Pick Color</button>',t+='<div\n\t\t\tclass="flexi-color-picker-wrapper"\n\t\t\tstyle="background:'.concat(this.color,'">\n\t\t\t\t<div class="flexi-color-picker"></div>\n\t\t\t\t<input\n\t\t\t\t\ttype="text"\n\t\t\t\t\tclass="flexi-color-hex"\n\t\t\t\t\tvalue="').concat(this.color,'"\n\t\t\t\t\tplaceholder="').concat(this.color,'"\n\t\t\t\t\tstyle="text-align: center;"\n\t\t\t\t/>\n\t\t\t\t<div class="default-palette-wrapper palette">').concat(this.getDefaultPalette(),'</div>\n\t\t\t\t<div class="flexi-color-picker-actions">\n\t\t\t\t\t').concat(e,"\n\t\t\t\t</div>\n\t\t\t</div>")}},{key:"getDefaultPalette",value:function(){var t="";return settingsPalette.forEach((function(e){var n=e;"transparent"===n&&(n=""),t+='\n\t\t\t\t\t<button\n\t\t\t\t\t\tstyle="background:'.concat(n,'"\n\t\t\t\t\t\tdata-color="').concat(e,'"\n\t\t\t\t\t\tclass="default-palette"\n\t\t\t\t\t>').concat(e,"</button>\n\t\t\t\t")})),t}},{key:"click",value:function(t){var e=t.target,n=e.classList;if(!n.contains("default-palette"))return n.contains("action-reset")?(ninjaEvent("reset-color-palette"),ninjaEvent("change-color"),void modal.reset()):n.contains("action-pick")?(ninjaEvent("select-color-picker-color",{name:ninjaData.getData().activeToolTab,type:this.type,color:this.color}),void modal.reset()):void 0;var a=e.getAttribute("data-color");a&&this.setColor(a)}},{key:"updateFromHex",value:function(t){6!==(t=t.replace("#","").toUpperCase()).length&&3!==t.length||(/^[0-9A-F]{6}$/i.test(t)||/^[0-9A-F]{3}$/i.test(t))&&this.setColor("#"+t)}}]),t}(),palette={app:void 0,init:function(){var t=document.querySelector(".palette");palette.app=new Reef(t,{data:fileData.data,template:palette.template,attachTo:[fileData]}),palette.app.render(),t.addEventListener("click",palette.click),document.addEventListener("reset-color-palette",palette.resetColorPaletteEvent),document.addEventListener("select-color-picker-color",palette.selectColorPickerColorEvent)},template:function(t){var e="",n=0,a=t.activeColor;return"fill"===t.pickType&&(a=t.activeFill),t.palette.forEach((function(t){var o="";n===a&&(o="selected");var i=t;"transparent"===i&&(i=""),e+='<button\n\t\t\t\t\tid="palette-'.concat(n,'"\n\t\t\t\t\tdata-color="').concat(t,'"\n\t\t\t\t\tdata-name="').concat(ninjaData.getData().activeToolTab,'"\n\t\t\t\t\tdata-id="').concat(n,'"\n\t\t\t\t\tclass="').concat(o,'"\n\t\t\t\t\tstyle="background-color:').concat(i,';"\n\t\t\t\t\ttitle="Use ').concat(t,'"\n\t\t\t\t\ttype="button"\n\t\t\t\t\t>').concat(t,"</button>"),n++})),e},click:function(t){var e=t.target;if(0===e.id.lastIndexOf("palette",0)){var n="";if("fill"===fileData.data.pickType)n="activeFill";else n="activeColor";debugComment("palette: Set the color for the current colour mode."),fileData.setData(_defineProperty({},n,parseInt(e.getAttribute("data-id")))),ninjaEvent("change-color",{name:e.getAttribute("data-name"),type:"color-palette"})}},resetColorPaletteEvent:function(t){debugComment("palette: Reset the colour palette to the default."),fileData.setData({palette:[].concat(settingsPalette)})},selectColorPickerColorEvent:function(t){var e=t.detail.color,n=t.detail.type,a="line"===fileData.data.pickType?"activeColor":"activeFill";if("color-palette"===n){var o=fileData.data.palette.findIndex((function(t){return t===e}));if(o>-1)return debugComment("palette: Update the colour palette with the selected colour."),void fileData.setData(_defineProperty({},a,o));var i=_toConsumableArray(fileData.data.palette);i[fileData.data[a]]=e,debugComment("palette: Update the palette."),fileData.setData({palette:i}),ninjaEvent("change-color",{name:ninjaData.getData().activeToolTab,type:n,color:e})}}},_layers={app:void 0,init:function(){var t=document.querySelector(".canvas-layers");_layers.app=new Reef(t,{data:{objects:[]},template:_layers.template}),_layers.app.render(),t.addEventListener("click",_layers.click)},template:function(t){if(t.objects.length<=0)return'<div class="error show">There are no objects to list. You\'d better get drawing!</div>';var e="";return t.objects.forEach((function(t){e+='\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass="canvasLayer"\n\t\t\t\t\t\tdata-id="'.concat(t.id,'"\n\t\t\t\t\t\ttitle="Select this layer"\n\t\t\t\t\t><img src="').concat(t.thumb,'" /></button>')})),e},show:function(){var t=painting.canvas,e=[],n=0;t.forEachObject((function(t){var a=t.toDataURL(_layers.objectProperties(t));e.push({thumb:a,id:n}),n++})),e.reverse(),debugComment("layers: display layers objects"),_layers.app.setData({objects:e}),modal.show("#modal-layers")},objectProperties:function(t){var e=t.getBoundingRect(),n=Math.max(e.width,e.height),a=150/n,o=n,i=n;return e.width>e.height&&(i=n*(e.height/e.width)),e.width<e.height&&(o=n*(e.width/e.height)),{width:o,height:i,multiplier:a}},click:function(t){var e=t.target;if(e.classList.contains("canvasLayer")){var n=e.getAttribute("data-id"),a=painting.canvas.item(n);a&&(toolActions.select(a),modal.reset())}}},exportAnimation={app:void 0,renderDelay:100,init:function(){if(!exportAnimation.app){var t=document.querySelector("#export-animation");exportAnimation.app=new Reef(t,{data:{status:"menu",data:""},template:exportAnimation.template,allowHTML:!0}),exportAnimation.app.render(),t.addEventListener("click",exportAnimation.click),t.addEventListener("keyup",exportAnimation.change),t.addEventListener("change",exportAnimation.change)}},template:function(t){return"processing"===t.status?'\n\t\t\t\t<div class="loading">Processing &hellip;</div>\n\t\t\t\t'.concat(pushAds.getAd(),"\n\t\t\t"):"download"===t.status?"\n\t\t\t\t".concat(t.data,'\n\t\t\t\t<button class="button ghost greedy" data-action="export-another">Another Save</button>\n\t\t\t\t<button class="button ghost greedy" data-action="export-all-done">All done</button>\n\t\t\t\t').concat(pushAds.getAd(),"\n\t\t\t"):exportAnimation.templateMenu(t)},templateMenu:function(t){var e="";return e+=exportAnimation.templateFilename(),e+=exportAnimation.templateFileCaption(),e+=this.templateListButtons(settingsExport.options),"menu-more"===t.status?(e+="<hr />",e+=this.templateListButtons(settingsExport.more)):e+='<button class="button teeny" id="export-more">More +</button>',e+=pushAds.getAd()},templateFilename:function(){return'\n\t\t\t<form>\n\t\t\t\t<label>Name</label>\n\t\t\t\t<input type="text" value="'.concat(this.getFilename(),'" id="export-filename" />\n\t\t\t</form>\n\t\t')},templateFileCaption:function(){var t=!1;return"displayCaptions"in fileData.data&&(t=fileData.data.displayCaptions),console.log(fileData.data),'\n\t\t\t<form>\n\t\t\t\t<label for="export-displayCaption" class="checkbox" id="export-displayCaptionLabel">\n\t\t\t\t\t<input type="checkbox" id="export-displayCaption" '.concat(t?"checked":""," />\n\t\t\t\t\tDisplay Captions\n\t\t\t\t</label>\n\t\t\t</form>\n\t\t")},templateListButtons:function(t){var e="";return t.forEach((function(t){var n="";""!==t.description&&(n='<p id="description-'.concat(t.action,'">').concat(t.description,"</p>")),e+='\n\t\t\t\t\t<div class="button-description">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass="button greedy"\n\t\t\t\t\t\t\tdata-action="export-'.concat(t.action,'"\n\t\t\t\t\t\t\taria-describedby="description-').concat(t.action,'"\n\t\t\t\t\t\t>').concat(t.label,"</button>\n\t\t\t\t\t\t").concat(n,"\n\t\t\t\t\t</div>\n\t\t\t\t")})),e},change:function(t){var e=t.target;"export-filename"===e.id&&(debugComment("export: Set the animation filename."),fileData.setData({filename:e.value}))},click:function(t){var e=t.target;if("export-more"===e.id)return debugComment('export: list "more" export options.'),void exportAnimation.app.setData({status:"menu-more"});if("export-displayCaption"!==e.id&&"export-displayCaptionLabel"!==e.id){var n="",a=null,o=e.getAttribute("data-action");"allow-click"!==o&&(t.stopPropagation(),t.preventDefault(),"export-gif"===o&&(n="processing",a=exportGif.gifClassic),"export-twitter-gif"===o&&(n="processing",a=exportGif.gifTwitter),"export-image-sequence"===o&&(n="processing",a=exportZip.generate),"export-save"===o&&(n="processing",a=exportFile.generate),"export-image"===o&&(n="processing",a=exportComic.generate),"export-comic"===o&&(n="processing",a=function(){exportComic.generate("black",4)}),"export-another"===o&&(n="menu"),"export-all-done"===o&&modal.reset(),""!==n&&(debugComment("export: change export mode"),exportAnimation.app.setData({status:n})),null!==a&&a())}else fileData.setData({displayCaptions:e.checked})},link:function(t,e,n){return n?'\n\t\t\t<div class="button-description">\n\t\t\t\t<a\n\t\t\t\t\thref="'.concat(URL.createObjectURL(n),'"\n\t\t\t\t\tclass="file-download button greedy"\n\t\t\t\t\tid="export-animation"\n\t\t\t\t\tdata-action="allow-click"\n\t\t\t\t\tdownload="').concat(this.getSafeFilename(),".").concat(t,'"\n\t\t\t\t>').concat(e,"</a>\n\t\t\t\t<p>By default saves to your 'Downloads' folder.</p>\n\t\t\t</div>\n\t\t"):(trackError("Error exporting ".concat(t," file: ").concat(n)),'<div class="error show">\n\t\t\t\t<p>There was an error saving your '.concat(t," file. Please try again later.</p>\n\t\t\t</div>"))},getFilename:function(){var t="animation";return fileData.data.filename&&(t=fileData.data.filename),t},getSafeFilename:function(){return urlString(this.getFilename())}},saveAnimation={app:void 0,saveDelay:1e3,init:function(){if(!saveAnimation.app){var t=document.querySelector("#save-animation");saveAnimation.app=new Reef(t,{data:{status:"menu",data:""},template:saveAnimation.template,allowHTML:!0}),saveAnimation.app.render(),t.addEventListener("click",exportAnimation.click),t.addEventListener("keyup",exportAnimation.change),t.addEventListener("change",exportAnimation.change),t.addEventListener("keyup",saveAnimation.change),t.addEventListener("change",saveAnimation.change)}},change:function(){exportFile.get_download_link(),exportFile.stop()},template:function(t){var e="";return e+=exportAnimation.templateFilename(),"download"===t.status?e+"\n\t\t\t\t".concat(t.data,'\n\t\t\t\t<button class="button ghost greedy" data-action="export-all-done">All done</button>\n\t\t\t\t').concat(pushAds.getAd(),"\n\t\t\t"):'\n\t\t\t<div class="loading">Processing &hellip;</div>\n\t\t\t'.concat(pushAds.getAd(),"\n\t\t")},run:function(){saveAnimation.init(),debugComment("save: process mode"),saveAnimation.app.setData({status:"processing"}),modal.show("#modal-save-animation"),setTimeout((function(){exportFile.generate()}),100)}};ready((function(){controls.init(),playback.init(),toolTabs.init(),toolType.init(),tools.init(),palette.init(),paletteColorPicker.init(),paletteColorType.init(),_layers.init(),textInput.init(),timeline.init(),toolShapes.init(),toolSelect.init(),toolBrushes.init(),toolLines.init(),toolText.init(),appNavigation.init(),painting.init(),modal.init(),fileUndo.init(),saveBrowser.init(),colorPicker.init(),onionSkin.init(),settings.init(),ninjaDataReset(),saveBrowser.loadLocal()}));
//# sourceMappingURL=../build-maps/app-brush-ninja.min.js.map
